<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0048)http://www.codeproject.com/KB/cs/WeakEvents.aspx -->
<HTML><HEAD><TITLE>Weak Events in C# - CodeProject</TITLE><LINK rel=stylesheet 
type=text/css 
href="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/CodeProject.min.css">
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<META name=Description 
content="Different approaches to weak events; Author: Daniel Grunwald; Section: C#; Chapter: Languages">
<META name=Keywords 
content=".NET2.0, .NET3.0, .NET3.5, C#, Dev, WPF, Intermediate, Advanced,C#,Languages,Free source code, tutorials">
<META name=Author content="The Code Project">
<META name=Rating content=General>
<META name=Robots content="index, follow">
<META name=Revisit-After content="1 days">
<META name=google-site-verification 
content=RP2bNCUeOmNkkJesEnU8X3UyTbqIcCKP0CmdwU8in5k><LINK 
title="CodeProject Latest articles - All topics" rel=alternate 
type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1"><LINK 
title="CodeProject Latest articles - MFC / C++" rel=alternate 
type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2"><LINK 
title="CodeProject Latest articles - C#" rel=alternate type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3"><LINK 
title="CodeProject Latest articles - ASP.NET" rel=alternate 
type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4"><LINK 
title="CodeProject Latest articles - .NET" rel=alternate 
type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5"><LINK 
title="CodeProject Latest articles - VB.NET" rel=alternate 
type=application/rss+xml 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6"><LINK 
title="CodeProject Lounge Postings" rel=alternate type=application/rss+xml 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx"><LINK 
title=CodeProject rel=search type=application/opensearchdescription+xml 
href="http://www.codeproject.com/info/OpenSearch.xml"><LINK rel=icon 
type=image/ico href="/favicon.ico"><LINK rel="shortcut icon" type=image/ico 
href="/favicon.ico"><LINK rel=apple-touch-icon type=image/png 
href="/images/FavIcon-Apple.png">
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if(top!=self)top.location.href=location.href; if(typeof(DemoUrl)!="undefined")document.write(unescape('%3Cme')+'ta http'+'-equiv="re' +'fresh" con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
function SelfCheck(){ return window.confirm("You are about to reply to your own message. Is this really what you want?");}
var Selected = "-1";
function Pin(elm){
 CloseMsg(Selected);
 var wrk=elm.parentNode; if(wrk)wrk=wrk.children[0];
 var fc=elm?elm.firstChild:null;
 if (wrk&&!wrk.pinned) {
  OpenMsg(wrk.name, true);wrk.pinned=true;fc.src='http://s.codeproject.com/script/forums/images/pinned.gif';fc.title='Pinned. Click to unpin'
 } else {
  wrk.pinned=false;CloseMsg(wrk.name); fc.src='http://s.codeproject.com/script/forums/images/pin.gif';fc.title='Click to pin message'
 }
 return false;
}
function CloseMsg(msgId) {
 if(!msgId||msgId==''||msgId<0)return;
 var lnk=document.getElementsByName(msgId);
 if(lnk&&lnk.length>0&&lnk[0].pinned)return;
 var hed=document.getElementById('F' + msgId.toString() + '_h0');
 if(hed) hed.className = hed.className.replace("Sel", "UnSel");
 var bdy=document.getElementById('F' + msgId.toString() + '_h1');
 if(bdy) bdy.style.display = 'none';
}
function OpenMsg(msgId, keep) {
 if(!msgId||msgId==''||msgId<0)return;
 var bdy=document.getElementById('F' + msgId.toString() + '_h1');
 if(bdy){
  var lnk=document.getElementsByName(msgId);
  if(lnk&&lnk.length>0&&lnk[0].pinned)keep=true;
  if(keep&&bdy.style.display!='none')return;
  if(bdy.style.display=='none') bdy.style.display='';
  else bdy.style.display = 'none';
 }
 var hed=document.getElementById('F' + msgId.toString() + '_h0');
 if (hed) hed.className = hed.className.replace('UnSel', 'Sel');
 if(bdy&&hed&&bdy.style.display!='none'){
  var webkitWeird=document.documentElement.scrollTop < document.body.scrollTop;
  if (!webkitWeird)document.body.scrollTop = getRealPos(hed, 'Top') - document.body.clientHeight/10;
  EnsureMessageVisible(msgId, true);
 }
}
function EnsureMessageVisible(msgID, bShowTop) {
	var webkitWeird = document.documentElement.scrollTop < document.body.scrollTop;
	var msgHeader = document.getElementById('F' + msgID + '_h0');
	var msgBody = document.getElementById('F' + msgID + '_h1');
	if (!msgBody || !msgHeader) return;
	var scrollContainer = document.documentElement;
	var top = getRealPos(msgHeader, 'Top');
	var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;
	var scrollTop = webkitWeird? scrollTop = document.body.scrollTop:document.documentElement.scrollTop;
	if (scrollTop > top && !bShowTop) scrollTop = top - scrollContainer.clientHeight / 10;
	if (scrollTop + scrollContainer.clientHeight < bottom) scrollTop = bottom - scrollContainer.clientHeight;
	if (scrollTop > top && bShowTop) scrollTop = top - scrollContainer.clientHeight / 10;
	if (webkitWeird) document.body.scrollTop = scrollTop; else scrollContainer.scrollTop = scrollTop;
}
function getRealPos(i,which) {
	iPos = 0;
	while (i!=null)  {
		iPos += i['offset' + which];
		i = i.offsetParent;
	}
	return iPos;
}

function SwitchMessage(e, msgId)
{

  if (msgId) msgId=msgId.toString();

  else {

    if(!e)e=window.event;

    var target=e.target?e.target:e.srcElement;

    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    if(target.pinned){Selected='';return false;}
    msgId=target.name;
  }
  CloseMsg(Selected)
  if(Selected==msgId) Selected='';
  else { OpenMsg(msgId, false); Selected=msgId;}
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}


//]]>
</SCRIPT>

<META name=GENERATOR content="MSHTML 8.00.7600.16700"></HEAD>
<BODY><A href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#Main"><IMG 
class=access-link alt="Click here to Skip to main content" 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t.gif"></A> 
<DIV class=page-background>
<DIV id=A class=container-content>
<DIV class="container nav-memberbar clearfix">
<DIV class="member-stats float-left">7,507,687 members and growing! (27,706 
online)</DIV>
<DIV class=float-left></DIV>
<DIV class=float-right><A name=SignUp></A>
<FORM id=subForm class=tight method=post name=subForm 
action=https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx><!-- This hidden field is used for identifying the form which has made post request.
		 (This form posts to another page and we need to know which form did the post request) --><INPUT 
id=FormName value=MenuBarForm type=hidden name=FormName> Email <INPUT 
style="WIDTH: 150px" id=Email class=small-text type=text name=Email> Password 
<INPUT style="WIDTH: 60px" id=Password class=small-text type=password 
name=Password> <INPUT class=button value="Sign in" type=submit>
<SCRIPT type=text/javascript>
function Join(){document.location.href='https://www.codeproject.com/script/Membership/Modify.aspx';return false;}
document.write('<input type="button" class="button" onclick="return Join();" value="Join"');
document.write('<input type="hidden" name="fld_quicksign" value="true" />');
</SCRIPT>
 <SPAN class=nowrap><INPUT id=RememberMeCheck value=1 CHECKED type=checkbox 
name=RememberMeCheck> <LABEL for=RememberMeCheck>Remember&nbsp;me?</LABEL> 
</SPAN>&nbsp; <A id=ctl00_MemberMenu_SendPassword 
href="http://www.codeproject.com/script/Membership/SendPassword.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Lost 
password?</A> </FORM></DIV></DIV>
<TABLE border=0 cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR>
    <TD class=header><A href="http://www.codeproject.com/"><IMG 
      style="BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" 
      id=ctl00_Logo title="The Code Project" alt=Home 
      src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/logo225x90.gif"></A></TD>
    <TD class=header align=right>
      <DIV class=lqm_ad 
      lqm_tags=".NET2.0,.NET3.0,.NET3.5,C#,Dev,WPF,Intermediate,Advanced" 
      lqm_country="CH" lqm_format="8" lqm_zone="77" lqm_publisher="495" 
      lqm_channel="1" height="90px" width="728px"></DIV></TD></TR></TBODY></TABLE>
<TABLE class="contrast1-background extended" cellSpacing=0 cellPadding=0>
  <TBODY>
  <TR>
    <TD noWrap>
      <DIV class="navbar clearfix">
      <UL id=nav>
        <LI><A id=ctl00_TopNavBar_Home class=down 
        href="http://www.codeproject.com/">Home</A> </LI>
        <LI><A id=ctl00_TopNavBar_Art class="down selected" 
        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A> 

        <UL>
          <LI><A id=ctl00_TopNavBar_ArtTopicList class="fly last" 
          onmouseover="PopulateMap(this, 'siteMap', '600px');" 
          href="http://www.codeproject.com/script/Content/SiteMap.aspx">Chapters 
          and Sections</A>
          <UL id=ctl00_TopNavBar_MapFlyout>
            <LI>
            <DIV 
            style="BORDER-BOTTOM: green 1px solid; BORDER-LEFT: green 1px solid; BACKGROUND-COLOR: white; WIDTH: 0px; HEIGHT: 0px; OVERFLOW: scroll; BORDER-TOP: green 1px solid; BORDER-RIGHT: green 1px solid" 
            id=siteMap><IMG style="MARGIN: 150px; WIDTH: 100px; HEIGHT: 100px" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/animated.gif"> 
            </DIV></LI></UL></LI>
          <LI><A id=ctl00_TopNavBar_ArtSearch class="fly break" 
          href="http://www.codeproject.com/info/search.aspx">Search</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtLatestArts class=fly 
          href="http://www.codeproject.com/script/Articles/Latest.aspx">Latest 
          Articles</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtLatestTips class=fly 
          href="http://www.codeproject.com/script/Articles/Latest.aspx?at=6">Latest 
          Tips/Tricks</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtTop class=fly 
          href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=4">Top 
          Articles</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtBeginner class=fly 
          href="http://www.codeproject.com/info/search.aspx?aidlst=152&amp;sa_us=True">Beginner 
          Articles</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtBlogArticles class="fly break" 
          href="http://www.codeproject.com/script/Articles/BlogArticleList.aspx">Technical 
          Blogs</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtPostArticle class=fly 
          href="http://www.codeproject.com/info/Submit.aspx">Post an 
          Article</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtPostTipTrick class=fly 
          href="http://www.codeproject.com/Tips/post.aspx">Post Tip &amp; 
          Trick</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtPostBlog class="fly break" 
          href="http://www.codeproject.com/script/Articles/BlogFeed.aspx">Post 
          your Blog</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtGuide class=fly 
          href="http://www.codeproject.com/info/Submit.aspx">Posting/Update 
          Guidelines</A></LI>
          <LI><A id=ctl00_TopNavBar_ArtCompetition class="fly last" 
          href="http://www.codeproject.com/script/Awards/CurrentCompetitions.aspx?cmpTpId=1">Article 
          Competition</A></LI></UL></LI>
        <LI><A id=ctl00_TopNavBar_Answers 
        href="http://www.codeproject.com/script/Answers/List.aspx?tab=active">Questions 
        &amp; Answers</A> 
        <UL>
          <LI id=ctl00_TopNavBar_AQL><A id=ctl00_TopNavBar_ArticleQuestion 
          class="fly highlight" 
          href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#_comments">Ask 
          a Question about this article</A></LI>
          <LI class=heading>Quick Answers</LI>
          <LI><A id=ctl00_TopNavBar_QAAsk class=fly 
          href="http://www.codeproject.com/Questions/ask.aspx">Ask a 
          Question</A></LI>
          <LI><A id=ctl00_TopNavBar_QAUnanswered class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View 
          Unanswered Questions</A></LI>
          <LI><A id=ctl00_TopNavBar_QALatest class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active">View 
          All Questions...</A></LI>
          <LI><A style="PADDING-LEFT: 30px" id=ctl00_TopNavBar_QATR_ctl00_Tag 
          class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;tags=81">C# 
          questions</A></LI>
          <LI><A style="PADDING-LEFT: 30px" id=ctl00_TopNavBar_QATR_ctl01_Tag 
          class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;tags=85">ASP.NET 
          questions</A></LI>
          <LI><A style="PADDING-LEFT: 30px" id=ctl00_TopNavBar_QATR_ctl02_Tag 
          class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;tags=842">VB.NET 
          questions</A></LI>
          <LI><A style="PADDING-LEFT: 30px" id=ctl00_TopNavBar_QATR_ctl03_Tag 
          class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;tags=78">C++ 
          questions</A></LI>
          <LI><A style="PADDING-LEFT: 30px" id=ctl00_TopNavBar_QATR_ctl04_Tag 
          class=fly 
          href="http://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;tags=69">C#3.0 
          questions</A></LI>
          <LI class=heading>Programming Discussions</LI>
          <LI><A id=ctl00_TopNavBar_MessageBoardsAll class=fly 
          href="http://www.codeproject.com/script/Forums/List.aspx">All Message 
          Boards...</A></LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application 
          Lifecycle<SPAN class=fly-menu>&gt;</SPAN></A> 
          <UL>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design 
            and Architecture</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running 
            a Business</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales 
            / Marketing</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration 
            / Beta Testing</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/3304/Work-Training-Issues.aspx">Work 
            &amp; Training Issues</A></LI></UL></LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / 
          C++ / MFC<SPAN class=fly-menu>&gt;</SPAN></A> 
          <UL>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL / 
            WTL / STL</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed 
            C++/CLI</A></LI></UL></LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1649/Csharp.aspx">C#</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1725/Database.aspx">Database</A> 
          </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1642/IT-Infrastructure.aspx">IT 
          &amp; Infrastructure<SPAN class=fly-menu>&gt;</SPAN></A> 
          <UL>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware 
            &amp; Devices</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1644/System-Admin.aspx">System 
            Admin</A></LI></UL></LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1643/Java.aspx">Java</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET 
          Framework</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</A> 
          </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1540733/Sharepoint.aspx">Sharepoint</A> 
          </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight 
          / WPF</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual 
          Basic</A> </LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1640/Web-Development.aspx">Web 
          Development<SPAN class=fly-menu>&gt;</SPAN></A> 
          <UL>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1580227/CSS.aspx">CSS</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1580226/Javascript.aspx">Javascript</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1213656/PHP.aspx">PHP</A></LI></UL></LI>
          <LI><A style="PADDING-LEFT: 30px" class=fly 
          href="http://www.codeproject.com/Forums/1645/Site-Bugs-Suggestions.aspx">Site 
          Bugs / Suggestions</A> </LI>
          <LI class=heading>Other Languages<SPAN class=fly-menu>&gt;</SPAN> 
          <UL>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1580229/Hindi.aspx">General 
            Indian Topics</A></LI>
            <LI><A class=fly 
            href="http://www.codeproject.com/Forums/1580230/Chinese.aspx">General 
            Chinese Topics</A></LI></UL></LI></UL></LI>
        <LI><A id=ctl00_TopNavBar_Zones 
        href="http://www.codeproject.com/Zones/index.aspx">Learning Zones</A> 
        <UL><!--<li class="heading">Zones</li>-->
          <LI><A class=fly href="http://www.codeproject.com/Zones/Commerce/">The 
          Commerce Zone</A></LI>
          <LI><A class=fly href="http://www.codeproject.com/Zones/Mobile/">The 
          Mobile Zone</A></LI>
          <LI><A class=fly href="http://www.codeproject.com/Zones/Cloud/">The 
          Cloud Zone</A></LI>
          <LI><A class=fly href="http://www.codeproject.com/Zones/Hardware/">The 
          Hardware Zone</A></LI>
          <LI><A class=fly 
          href="http://www.codeproject.com/Zones/Parallelism/">The Parallelism 
          Zone</A></LI>
          <LI><A class=fly 
          href="http://www.codeproject.com/Zones/WPF-Silverlight/">The WPF / 
          Silverlight Zone</A></LI>
          <LI><A class=fly href="http://www.codeproject.com/Zones/dotnet/">The 
          .NET Zone</A></LI>
          <LI><A class=fly 
          href="http://www.codeproject.com/Zones/SqlServer/">The SQL 
          Zone</A></LI>
          <LI><A class="fly break" 
          href="http://www.codeproject.com/Zones/WhitePapers/">WhitePapers / 
          Webcasts</A></LI>
          <LI><A id=ctl00_TopNavBar_Solutions class="fly last" 
          href="http://www.codeproject.com/kb/Solution-Center/">Solutions 
          Center</A></LI></UL></LI>
        <LI><A id=ctl00_TopNavBar_Community>Features</A> 
        <UL>
          <LI><A id=ctl00_TopNavBar_WhosWho class=fly 
          href="http://www.codeproject.com/script/Membership/Profiles.aspx">Who's 
          Who</A></LI>
          <LI><A id=ctl00_TopNavBar_MVPs class=fly 
          href="http://www.codeproject.com/script/Awards/MVPWinners.aspx">CodeProject 
          MVPs</A></LI>
          <LI><A id=ctl00_TopNavBar_Companies class="fly break" 
          href="http://www.codeproject.com/script/Membership/Profiles.aspx?mgtid=1&amp;mgm=True">Company 
          Listings</A></LI>
          <LI><A id=ctl00_TopNavBar_Catalog class=fly 
          href="http://www.codeproject.com/script/Catalog/List.aspx">Component 
          &amp; Service Catalog</A></LI>
          <LI><A id=ctl00_TopNavBar_Comps class=fly 
          href="http://www.codeproject.com/script/Awards/CurrentCompetitions.aspx?cmpTpId=1&amp;awsac=true">Competitions</A></LI>
          <LI><A id=ctl00_TopNavBar_News class=fly 
          href="http://www.codeproject.com/script/News/List.aspx">News</A></LI>
          <LI><A id=ctl00_TopNavBar_Insider class=fly 
          href="http://www.codeproject.com/Feature/Insider/">Daily 
          Insider</A></LI>
          <LI><A id=ctl00_TopNavBar_Newsletters class=fly 
          href="http://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter 
          archive</A></LI>
          <LI><A id=ctl00_TopNavBar_PressRelease class=fly 
          href="http://www.codeproject.com/script/PressReleases/Preview.aspx">Press 
          Releases</A></LI>
          <LI><A id=ctl00_TopNavBar_Surveys class=fly 
          href="http://www.codeproject.com/script/Surveys/List.aspx">Surveys</A></LI>
          <LI><A id=ctl00_TopNavBar_Stuff class=fly 
          href="http://www.codeproject.com/Info/Stuff.aspx">CodeProject 
          Stuff</A></LI>
          <LI><A id=ctl00_TopNavBar_AddIn class="fly last" 
          href="http://www.codeproject.com/Services/Addins/">CodeProject VS 
          Addin </A></LI></UL></LI>
        <LI><A id=ctl00_TopNavBar_Help 
        href="http://www.codeproject.com/KB/FAQs/">Help!</A> 
        <UL>
          <LI><A id=ctl00_TopNavBar_HelpWhatIs class=fly 
          href="http://www.codeproject.com/info/guide.aspx">What is 'The Code 
          Project'?</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpGeneral class=fly 
          href="http://www.codeproject.com/KB/FAQs/">General FAQ</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpPostQuestion class=fly 
          href="http://www.codeproject.com/Questions/ask.aspx">Post a 
          Question</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpBugs class=fly 
          href="http://www.codeproject.com/Forums/1645/Site-Bugs-Suggestions.aspx">Bugs 
          and Suggestions</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpSiteMap class=fly 
          href="http://www.codeproject.com/script/Content/SiteMap.aspx">Site 
          Directory</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpAdvertise class=fly 
          href="http://www.codeproject.com/info/MediaKit.aspx">Advertise with 
          us</A></LI>
          <LI><A id=ctl00_TopNavBar_HelpAboutUs class="fly last" 
          href="http://www.codeproject.com/info/about.aspx">About 
        Us</A></LI></UL></LI>
        <LI style="MARGIN-LEFT: 10px"><A id=ctl00_TopNavBar_Lounge class=simple 
        href="http://www.codeproject.com/Lounge.aspx">The Lounge</A> 
        <UL>
          <LI><A id=ctl00_TopNavBar_LoungeLnk class=fly 
          href="http://www.codeproject.com/Lounge.aspx">The Lounge 
          &nbsp;</A></LI>
          <LI><A id=ctl00_TopNavBar_CleverLnk class=fly 
          href="http://www.codeproject.com/feature/CleverCode.aspx">Clever 
          Code</A></LI>
          <LI><A id=ctl00_TopNavBar_ShameLnk class=fly 
          href="http://www.codeproject.com/feature/HallOfSHame.aspx">Hall of 
          Shame</A></LI>
          <LI><A id=ctl00_TopNavBar_SoapBoxLnk class=fly 
          href="http://www.codeproject.com/Forums/1536756/The-Soapbox-2-0.aspx">The 
          Soapbox</A></LI></UL></LI></UL></DIV>
      <SCRIPT type=text/javascript>
function PopulateMap(prnt, elmId, width, height) {
	var map;
	if (!prnt.populated && !prnt.populating) {
		prnt.populating = true;
		map = $('#' + elmId);
		map.css('height', '400px');
		map.css('width', '400px');
		map.load("/script/content/ajax/SiteMap.aspx", function () {
			if (height) map.css('height', height); else map.css('height', 'auto');
			prnt.populated = true;
		});
		prnt.populating = false;
	}
	if (prnt.populated) {
		map = map||$('#' + elmId);
		var defWidth = ($(window).width() * 0.9);
		if (defWidth > 1000) defWidth = 1000;
		if (width) map.css('width', width); else map.css('width', defWidth+'px');
	}
}
</SCRIPT>
    </TD>
    <TD align=right>
      <DIV class=search-bar>
      <FORM class=tight method=get name=Search action=/info/search.aspx><INPUT 
      id=sb_tb class="search " name=artkw> 
      <DIV class=hover-container>
      <DIV id=SearchFilter 
      class="search-advanced popup small-text align-left"><B>Search 
      within:<BR></B><INPUT id=sb_kw value=kw CHECKED type=radio name=sbo><LABEL 
      for=sb_kw>Articles</LABEL><BR><INPUT id=sb_qa value=qa type=radio 
      name=sbo><LABEL for=sb_qa>Quick Answers</LABEL><BR><INPUT id=sb_fm 
      value=fm type=radio name=sbo><LABEL for=sb_fm>Messages</LABEL><BR><INPUT 
      id=sb_ctlk value=ctlk type=radio name=sbo><LABEL for=sb_ctlk>Product 
      Catalog</LABEL><BR></DIV></DIV></FORM></DIV></TD></TR></TBODY></TABLE>
<DIV class=container-article>
<DIV class=container-header>
<DIV id=ctl00_Header class=header><A name=Main></A><A name=_top></A>
<DIV class="clearfix hover-container">
<DIV class=container>
<DIV class="breadcrumb float-left"><A 
href="http://www.codeproject.com/script/Content/SiteMap.aspx"><SPAN 
class=sitemap-anchor onmouseover="PopulateMap(this,'map');"><IMG 
style="VERTICAL-ALIGN: middle" border=0 alt="Site map" 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/sitemap16.png" 
width=16 height=16>
<DIV id=map><IMG 
style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; MARGIN: 150px; WIDTH: 100px; HEIGHT: 100px; BORDER-TOP: 0px; BORDER-RIGHT: 0px" 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/animated.gif"></DIV></SPAN></A>» 
<A href="http://www.codeproject.com/Chapters/5/Languages.aspx">Languages</A> » 
<A href="http://www.codeproject.com/KB/cs/">C#</A> » <A 
href="http://www.codeproject.com/KB/cs/#Delegates and Events">Delegates and 
Events</A></DIV>
<DIV class=float-right><A id=ctl00_TitleArea_PageWidth_Fixed 
title="Fixed width layout" 
href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?PageFlow=FixedWidth"><IMG 
style="WIDTH: 18px; HEIGHT: 18px" class=toolbar 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/fixed-width.png"></A> 
<A id=ctl00_TitleArea_PageWidth_Fluid title="Fluid layout" 
href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?PageFlow=Fluid"><IMG 
style="WIDTH: 18px; HEIGHT: 18px" class=toolbar 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/fluid-width.png"></A> 
</DIV></DIV>
<DIV id=ctl00_TitleArea_InfoArea class=float-right>
<DIV class=infobox>
<TABLE class="tight small-text" cellSpacing=1 cellPadding=0>
  <TBODY>
  <TR>
    <TD>Licence&nbsp;</TD>
    <TD><A title="The MIT License" 
      href="http://www.opensource.org/licenses/mit-license.php">MIT</A></TD></TR>
  <TR>
    <TD>First Posted&nbsp;</TD>
    <TD noWrap><B>5 Oct 2008</B></TD></TR>
  <TR>
    <TD>Views&nbsp;</TD>
    <TD><B>98,284</B></TD></TR>
  <TR>
    <TD>Bookmarked&nbsp;</TD>
    <TD><B>317 times</B></TD></TR>
  <TR vAlign=top>
    <TD>Tags&nbsp;</TD>
    <TD noWrap><SPAN id=ctl00_TitleArea_InfoBox_TagsList_TagWrp 
      class=tags><SPAN id=ctl00_TitleArea_InfoBox_TagsList_TagLabel 
      class=bold></SPAN><SPAN id=ctl00_TitleArea_InfoBox_TagsList_VisibleTags><A 
      href="http://www.codeproject.com/info/search.aspx?aidlst=12">.NET2.0</A>, 
      <A 
      href="http://www.codeproject.com/info/search.aspx?aidlst=66">.NET3.0</A>,<BR><A 
      href="http://www.codeproject.com/info/search.aspx?aidlst=76">.NET3.5</A>, 
      <A href="http://www.codeproject.com/info/search.aspx?aidlst=81">C#</A>, <A 
      href="http://www.codeproject.com/info/search.aspx?aidlst=118">Dev</A></SPAN><ACRONYM 
      id=ctl00_TitleArea_InfoBox_TagsList_HiddenTags 
      title="plus: WPF, Intermediate, Advanced">, +</ACRONYM> 
  </SPAN></TD></TR></TBODY></TABLE></DIV></DIV>
<H1 id=ctl00_TitleArea_ArticleTitle>Weak Events in C#</H1>
<DIV class=author>By <B><A 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=476847">Daniel 
Grunwald</A></B> | 25 Apr 2009 </DIV>
<DIV class=abstract><SPAN id=ctl00_TitleArea_ArticleDescr>Different approaches 
to weak events</SPAN></DIV></DIV></DIV>
<DIV id=ctl00_HeadSide class=header-sidebar>
<DIV style="HEIGHT: 24px" class=align-right> </DIV>
<DIV id=ctl00_SeeAlso_ZL class=zone>Part of <A id=ctl00_SeeAlso_ZoneLink 
class=bold href="http://www.codeproject.com/Zones/WPF-Silverlight/">The WPF / 
Silverlight Zone</A> <SPAN id=ctl00_SeeAlso_ZoneSponsor>sponsored by <A 
id=ctl00_SeeAlso_ZoneLnk 
href="http://www.codeproject.com/Zones/WPF-Silverlight/"><IMG 
style="BORDER-RIGHT-WIDTH: 0px; WIDTH: 48px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 24px; VERTICAL-ALIGN: middle; BORDER-LEFT-WIDTH: 0px" 
id=ctl00_SeeAlso_ZoneImg 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/XCEED_60x24.png"></A></SPAN> 
</DIV>
<DIV class="bold pad-top">See Also</DIV>
<UL style="MARGIN-LEFT: 5px" class="outdent small-text">
  <LI><A id=ctl00_SeeAlso_LikeThis 
  href="http://www.codeproject.com/info/search.aspx?artkw=Weak+Events+in+C%23">Articles 
  like this</A></LI>
  <LI><A id=ctl00_SeeAlso_ByAuthor 
  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=476847">Articles 
  by this author</A></LI></UL></DIV></DIV>
<DIV id=ctl00_Nav class=container-nav>
<DIV id=ctl00_TabContainer class="tabs container">
<DIV class="float-right action-links"><A id=ctl00_ActionLinks_PrintLnk 
class=tooltip 
href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?display=Print"><IMG 
style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; VERTICAL-ALIGN: middle; BORDER-TOP: 0px; BORDER-RIGHT: 0px" 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/print.gif" 
width=24 height=24> 
<DIV class=speech-bubble-container-up>
<DIV class=speech-bubble-up>Print Article</DIV>
<DIV class=speech-bubble-pointer-up>
<DIV class=speech-bubble-pointer-up-inner></DIV></DIV></DIV></A><IFRAME 
style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; WIDTH: 47px; HEIGHT: 23px; VERTICAL-ALIGN: bottom; OVERFLOW: hidden; BORDER-TOP: medium none; BORDER-RIGHT: medium none" 
id=ctl00_ActionLinks_AddTo_LikeBtn 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/f.htm" 
frameBorder=0 allowTransparency scrolling=no>
</IFRAME><SPAN id=SBI><IMG 
style="VERTICAL-ALIGN: bottom" id=ctl00_ActionLinks_AddTo_Img alt=add 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/share_drop16.png" 
width=14 height=23> </SPAN>
<DIV id=ATD class=list-socialbookmark></DIV><SPAN class=tooltip>
<DIV class=speech-bubble-container-up>
<DIV class=speech-bubble-up>Add to your CodeProject bookmarks</DIV>
<DIV class=speech-bubble-pointer-up>
<DIV class=speech-bubble-pointer-up-inner></DIV></DIV></DIV></SPAN><A 
class=tooltip 
href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#_comments"><IMG 
style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; VERTICAL-ALIGN: middle; BORDER-TOP: 0px; BORDER-RIGHT: 0px" 
alt=Discuss 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/discuss.gif" 
width=24 height=24> 
<DIV class=speech-bubble-container-up>
<DIV class=speech-bubble-up>Discuss this article</DIV>
<DIV class=speech-bubble-pointer-up>
<DIV class=speech-bubble-pointer-up-inner></DIV></DIV></DIV></A><SPAN 
style="MARGIN-LEFT: -4px" id=ctl00_ActionLinks_cmtcnt 
class="subdue small-text align-middle">53</SPAN> <A 
id=ctl00_ActionLinks_BrokenLnk class=tooltip 
href="http://www.codeproject.com/script/Articles/Report.aspx?aid=29922"><IMG 
style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; VERTICAL-ALIGN: middle; BORDER-TOP: 0px; BORDER-RIGHT: 0px" 
alt="Broken Article?" 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/report.gif" 
width=24 height=24> 
<DIV style="WIDTH: 140px" class=speech-bubble-container-up>
<DIV class=speech-bubble-up>Report this article as inappropriate</DIV>
<DIV class=speech-bubble-pointer-up>
<DIV class=speech-bubble-pointer-up-inner></DIV></DIV></DIV></A></DIV>
<DIV class=float-left>
<DIV class=float-left>
<TABLE cellSpacing=0 cellPadding=0>
  <TBODY>
  <TR>
    <TD class=tab-selected>Article</TD>
    <TD class=tab-unselected><A 
      href="http://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=29922">Browse 
      Code</A></TD>
    <TD class=tab-unselected><A 
      href="http://www.codeproject.com/script/Articles/Statistics.aspx?aid=29922">Stats</A></TD>
    <TD class=tab-unselected><A 
      href="http://www.codeproject.com/script/Articles/ListVersions.aspx?aid=29922">Revisions 
      (2)</A></TD></TR></TBODY></TABLE></DIV>
<DIV style="MARGIN-LEFT: 15px" class=float-left>
<DIV id=ctl00_CurRat class=tooltip name="CurRat_29922">
<TABLE class=small-text cellSpacing=0 cellPadding=0>
  <TBODY>
  <TR>
    <TD class=nowrap>
      <DIV style="POSITION: relative; WIDTH: 120px; HEIGHT: 24px">
      <TABLE class=rating-bar-stars border=0 cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD class=filled height=24 width=117></TD>
          <TD height=24 width=3></TD></TR></TBODY></TABLE><IMG 
      style="Z-INDEX: 10; POSITION: absolute; TOP: 0px; LEFT: 0px" 
      src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/stars_orange.gif" 
      width=120 height=24> </DIV></TD>
    <TD id=ctl00_ArticleRating_VR class=nowrap>&nbsp;<SPAN 
      id=ctl00_ArticleRating_VotesR>&nbsp;4.89 (154 votes)</SPAN> 
</TD></TR></TBODY></TABLE>
<DIV id=ctl00_RB class=speech-bubble-container-up>
<DIV style="WIDTH: 150px !important" class=speech-bubble-up>
<DIV>
<TABLE class=feature title="Voting Distribution. Recent data only" cellSpacing=0 
cellPadding=0>
  <TBODY>
  <TR>
    <TD class=chart-column><IMG title="1 vote, 0.6%" border=0 
      alt="1 vote, 0.6%" 
      src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pollcol.gif" 
      width=16 height=1><BR><SPAN title="1 vote">1</SPAN></TD>
    <TD class=chart-column><IMG title="2 votes, 1.3%" border=0 
      alt="2 votes, 1.3%" 
      src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pollcol.gif" 
      width=16 height=1><BR><SPAN title="2 votes">2</SPAN></TD>
    <TD class=chart-column><IMG title="1 vote, 0.6%" border=0 
      alt="1 vote, 0.6%" 
      src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pollcol.gif" 
      width=16 height=1><BR><SPAN title="1 vote">3</SPAN></TD>
    <TD class=chart-column><IMG title="6 votes, 3.9%" border=0 
      alt="6 votes, 3.9%" 
      src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pollcol.gif" 
      width=16 height=2><BR><SPAN title="6 votes">4</SPAN></TD>
    <TD class=chart-column><IMG title="144 votes, 93.5%" border=0 
      alt="144 votes, 93.5%" 
      src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pollcol.gif" 
      width=16 height=50><BR><SPAN 
title="144 votes">5</SPAN></TD></TR></TBODY></TABLE></DIV></DIV>
<DIV class=speech-bubble-pointer-up>
<DIV 
class=speech-bubble-pointer-up-inner></DIV></DIV></DIV></DIV></DIV></DIV></DIV>
<DIV id=ctl00_HeadSideFoot class=tabs-sidebar>
<DIV>Sponsored Links</DIV></DIV></DIV>
<DIV class=container-text>
<DIV id=AT class=text>
<FORM 
style="PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; PADDING-TOP: 0px" 
id=aspnetForm method=post name=aspnetForm action=/KB/cs/WeakEvents.aspx>
<DIV><INPUT id=__VIEWSTATE 
value=/wEPDwUKMTAyMTMzODg1Ng9kFgJmD2QWAgIED2QWCAIRD2QWAgIBD2QWBmYPDxYCHgtOYXZpZ2F0ZVVybAUyL3NjcmlwdC9BcnRpY2xlcy9BZG1pbi9FZGl0b3JDaG9pY2UuYXNweD9haWQ9Mjk5MjJkZAICDw8WAh8ABTgvc2NyaXB0L0F3YXJkcy9BZG1pbi9Bd2FyZE9iamVjdC5hc3B4P29iaWQ9Mjk5MjImb2J0aWQ9MmRkAgoPDxYCHwAFLy9zY3JpcHQvQXJ0aWNsZXMvQWRtaW4vUXVldWVFZGl0LmFzcHg/YWlkPTI5OTIyZGQCEw9kFgICAQ9kFgICAQ9kFgZmDw8WAh8ABSQvS0IvY3MvV2Vha0V2ZW50cy5hc3B4P2Rpc3BsYXk9UHJpbnRkZAIEDxYCHglpbm5lcmh0bWwFAjUzZAIFDw8WAh8ABSYvc2NyaXB0L0FydGljbGVzL1JlcG9ydC5hc3B4P2FpZD0yOTkyMmRkAhUPZBYCAgkPZBYIAgMPFgIeBmFjdGlvbgUWL0tCL2NzL1dlYWtFdmVudHMuYXNweBYEAgMPZBYCAgIPZBYCAgEPEGRkFgBkAgkPFgIeC18hSXRlbUNvdW50AgFkAgsPDxYCHwAFFi9LQi9jcy9XZWFrRXZlbnRzLmFzcHhkZAITDxYCHgRUZXh0BQsyNSBBcHIgMjAwOWQCFw8WAh8EBSFDb3B5cmlnaHQgMjAwOCBieSBEYW5pZWwgR3J1bndhbGRkAhcPZBYCAgUPDxYCHgdWaXNpYmxlaGRkZB2v7j+2hEXjkoyaUfxAdSG1TuDX 
type=hidden name=__VIEWSTATE> </DIV><!-- Article Text Start -->
<DIV id=contentdiv><!-- Article Starts -->
<UL class=download>
  <LI><A 
  href="http://www.codeproject.com/KB/cs/WeakEvents/WeakEvents.zip">Download 
  source code - 16.42 KB</A></LI></UL>
<H2>Table of contents</H2>
<UL>
  <LI><A 
  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0000">Introduction</A></LI>
  <LI><A 
  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0001">What 
  Exactly are Events?</A></LI>
  <LI><A 
  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0002">Part 1: 
  Listener-side Weak Events</A></LI>
  <UL>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0003">Solution 
    0: Just Deregister</A></LI>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0004">Solution 
    1: Deregister When the Event is Called</A></LI>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0005">Solution 
    2: Wrapper with Weak Reference</A></LI>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0006">Solution 
    3: Deregister in Finalizer</A></LI>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0007">Solution 
    4: Reusable Wrapper</A></LI>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0008">Solution 
    5: WeakEventManager</A></LI></UL>
  <LI><A 
  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0009">Part 2: 
  Source-side Weak Events</A></LI>
  <UL>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0010">Solution 
    0: Interface</A></LI>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0011">Solution 
    1: WeakReference to Delegate</A></LI>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0012">Solution 
    2: object + Forwarder</A></LI>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0013">Solution 
    3: SmartWeakEvent</A></LI>
    <LI><A 
    href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0014">Solution 
    4: FastSmartWeakEvent</A></LI></UL>
  <LI><A 
  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#heading0015">Suggestions</A></LI></UL>
<H2><A id=heading0000 name=heading0000>Introduction</A></H2>
<P>When using normal C# events, registering an event handler creates a strong 
reference from the event source to the listening object.</P><IMG 
alt=NormalEvent.png 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/NormalEvent.png" 
width=294 height=54> 
<P>If the source object has a longer lifetime than the listener, and the 
listener doesn't need the events anymore when there are no other references to 
it, using normal .NET events causes a memory leak: the source object holds 
listener objects in memory that should be garbage collected.</P>
<P>There are lots of different approaches to this problem. This article will 
explain some of them and discuss their advantages and disadvantages. I have 
sorted the approaches in two categories: first, we will assume that the event 
source is an existing class with a normal C# event; after that, we will allow 
modifying the event source to allow different approaches.</P>
<H2><A id=heading0001 name=heading0001>What Exactly are Events?</A></H2>
<P>Many programmers think events are a list of delegates - that's simply wrong. 
Delegates themselves have the ability to be "multi-cast":</P><PRE lang=cs>EventHandler eh = Method1;
eh += Method2;</PRE>
<P>So, what then are events? Basically, they are like properties: they 
encapsulate a delegate field and restrict access to it. A public delegate field 
(or a public delegate property) could mean that other objects could clear the 
list of event handlers, or raise the event - but we want only the object 
defining the event to be able to do that.</P>
<P>Properties essentially are a pair of 
<CODE>get</CODE>/<CODE>set</CODE>-methods. Events are just a pair of 
<CODE>add</CODE>/<CODE>remove</CODE>-methods.</P><PRE lang=cs><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>event</SPAN> EventHandler MyEvent {
   add { ... }
   remove { ... }
}</PRE>
<P>Only adding and removing handlers is <CODE><SPAN 
class=code-keyword>public</SPAN></CODE>. Other classes cannot request the list 
of handlers, cannot clear the list, or cannot call the event.</P>
<P>Now, what leads to confusion sometimes is that C# has a short-hand 
syntax:</P><PRE lang=cs><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>event</SPAN> EventHandler MyEvent;</PRE>
<P>This expands to:</P><PRE lang=cs><SPAN class=code-keyword>private</SPAN> EventHandler _MyEvent; <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> the underlying field</SPAN>
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> this isn't actually named "_MyEvent" but also "MyEvent",</SPAN>
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> but then you couldn't see the difference between the field</SPAN>
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> and the event.</SPAN>
<SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>event</SPAN> EventHandler MyEvent {
  add { <SPAN class=code-keyword>lock</SPAN>(<SPAN class=code-keyword>this</SPAN>) { _MyEvent += value; } }
  remove { <SPAN class=code-keyword>lock</SPAN>(<SPAN class=code-keyword>this</SPAN>) { _MyEvent -= value; } }
}</PRE>
<P>Yes, the default C# events are locking on <CODE><SPAN 
class=code-keyword>this</SPAN></CODE>! You can verify this with a disassembler - 
the <CODE>add</CODE> and <CODE>remove</CODE> methods are decorated with 
<CODE>[MethodImpl(MethodImplOptions.Synchronized)]</CODE>, which is equivalent 
to locking on <CODE><SPAN class=code-keyword>this</SPAN></CODE>.</P>
<P>Registering and deregistering events is thread-safe. However, raising the 
event in a thread-safe manner is left to the programmer writing the code that 
raises the event, and often gets done incorrectly: the raising code that's 
probably used the most is not thread-safe:</P><PRE lang=cs><SPAN class=code-keyword>if</SPAN> (MyEvent != <SPAN class=code-keyword>null</SPAN>)
   MyEvent(<SPAN class=code-keyword>this</SPAN>, EventArgs.Empty);
   <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> can crash with a NullReferenceException</SPAN>
   <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> when the last event handler is removed concurrently.</SPAN></PRE>
<P>The second most commonly seen strategy is first reading the event delegate 
into a local variable.</P><PRE lang=cs>EventHandler eh = MyEvent;
<SPAN class=code-keyword>if</SPAN> (eh != <SPAN class=code-keyword>null</SPAN>) eh(<SPAN class=code-keyword>this</SPAN>, EventArgs.Empty);</PRE>
<P>Is this thread-safe? Answer: it depends. According to the memory model in the 
C# specification, this is <STRONG>not</STRONG> thread-safe. The JIT compiler is 
allowed to eliminate the local variable, see <A 
href="http://msdn.microsoft.com/en-us/magazine/cc163715.aspx">Understand the 
Impact of Low-Lock Techniques in Multithreaded Apps</A> [<A title="New Window" 
href="http://msdn.microsoft.com/en-us/magazine/cc163715.aspx" 
target=_blank>^</A>]. However, the Microsoft .NET runtime has a stronger memory 
model (starting with version 2.0), and there, that code is thread-safe. It 
happens to be also thread-safe in Microsoft .NET 1.0 and 1.1, but that's an 
undocumented implementation detail.</P>
<P>A correct solution, according to the ECMA specification, would have to move 
the assignment to the local variable into a <CODE>lock(<SPAN 
class=code-keyword>this</SPAN>)</CODE> block or use a <CODE><SPAN 
class=code-keyword>volatile</SPAN></CODE> field to store the delegate.</P><PRE lang=cs>EventHandler eh;
<SPAN class=code-keyword>lock</SPAN> (<SPAN class=code-keyword>this</SPAN>) { eh = MyEvent; }
<SPAN class=code-keyword>if</SPAN> (eh != <SPAN class=code-keyword>null</SPAN>) eh(<SPAN class=code-keyword>this</SPAN>, EventArgs.Empty);</PRE>
<P>This means we'll have to distinguish between events that are thread-safe and 
events that are not thread-safe.</P>
<H2><A id=heading0002 name=heading0002>Part 1: Listener-side Weak 
Events</A></H2>
<P>In this part, we'll assume the event is a normal C# event (strong references 
to event handlers), and any cleanup will have to be done on the listening 
side.</P>
<H3><A id=heading0003 name=heading0003>Solution 0: Just Deregister</A></H3><PRE lang=cs><SPAN class=code-keyword>void</SPAN> RegisterEvent()
{
    eventSource.Event += OnEvent;
}
<SPAN class=code-keyword>void</SPAN> DeregisterEvent()
{
    eventSource.Event -= OnEvent;
}
<SPAN class=code-keyword>void</SPAN> OnEvent(<SPAN class=code-keyword>object</SPAN> sender, EventArgs e)
{
    ...
}</PRE>
<P>Simple and effective, this is what you should use when possible. But, often, 
it's not trivially possible to ensure the <CODE>DeregisterEvent</CODE> method is 
called whenever the object is no longer in use. You might try the Dispose 
pattern, though that's usually meant for unmanaged resources. A finalizer will 
not work: the garbage collector won't call it because the event source still 
holds a reference to our object!</P>
<H4>Advantages</H4>
<P>Simple if the object already has a notion of being disposed.</P>
<H4>Disadvantages</H4>
<P>Explicit memory management is hard, code can forget to call 
<CODE>Dispose</CODE>.</P>
<H3><A id=heading0004 name=heading0004>Solution 1: Deregister When the Event is 
Called</A></H3><PRE lang=cs><SPAN class=code-keyword>void</SPAN> RegisterEvent()
{
    eventSource.Event += OnEvent;
}

<SPAN class=code-keyword>void</SPAN> OnEvent(<SPAN class=code-keyword>object</SPAN> sender, EventArgs e)
{
    <SPAN class=code-keyword>if</SPAN> (!InUse) {
        eventSource.Event -= OnEvent;
        <SPAN class=code-keyword>return</SPAN>;
    }
    ...
}</PRE>
<P>Now, we don't require that someone tells us when the listener&nbsp;is no 
longer in use: it just checks this itself when the event is called. However, if 
we cannot use solution 0, then usually, it's also not possible to determine 
"<CODE>InUse</CODE>" from within the listener object. And given that you are 
reading this article, you've probably come across one of those cases.</P>
<P>But, this "solution" already has an important disadvantage over solution 0: 
if the event is never fired, then we'll leak listener objects. Imagine that lots 
of objects register to a <CODE><SPAN class=code-keyword>static</SPAN> 
</CODE>"<CODE>SettingsChanged</CODE>" event - all these objects cannot be 
garbage collected until a setting is changed - which might never happen in the 
program's lifetime.</P>
<H4>Advantages</H4>
<P>None.</P>
<H4>Disadvantages</H4>
<P>Leaks when the event never fires; usually, "<CODE>InUse</CODE>" cannot be 
easily determined.</P>
<H3><A id=heading0005 name=heading0005>Solution 2: Wrapper with Weak 
Reference</A></H3>
<P>This solution is nearly identical to the previous, except that we move the 
event handling code into a wrapper class that forwards the calls to a listener 
instance which is referenced with a weak reference. This weak reference allows 
for easy detection if the listener is still alive.</P>
<P><IMG alt=WeakEventWithWrapper.png 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/WeakEventWithWrapper.png" 
width=402 height=77></P><PRE lang=cs>EventWrapper ew;
<SPAN class=code-keyword>void</SPAN> RegisterEvent()
{
    ew = <SPAN class=code-keyword>new</SPAN> EventWrapper(eventSource, <SPAN class=code-keyword>this</SPAN>);
}
<SPAN class=code-keyword>void</SPAN> OnEvent(<SPAN class=code-keyword>object</SPAN> sender, EventArgs e)
{
    ...
}
<SPAN class=code-keyword>sealed</SPAN> <SPAN class=code-keyword>class</SPAN> EventWrapper
{
    SourceObject eventSource;
    WeakReference wr;
    <SPAN class=code-keyword>public</SPAN> EventWrapper(SourceObject eventSource,
                        ListenerObject obj) {
        <SPAN class=code-keyword>this</SPAN>.eventSource = eventSource;
        <SPAN class=code-keyword>this</SPAN>.wr = <SPAN class=code-keyword>new</SPAN> WeakReference(obj);
        eventSource.Event += OnEvent;
   }
   <SPAN class=code-keyword>void</SPAN> OnEvent(<SPAN class=code-keyword>object</SPAN> sender, EventArgs e)
   {
        ListenerObject obj = (ListenerObject)wr.Target;
        <SPAN class=code-keyword>if</SPAN> (obj != <SPAN class=code-keyword>null</SPAN>)
            obj.OnEvent(sender, e);
        <SPAN class=code-keyword>else</SPAN>
            Deregister();
    }
    <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>void</SPAN> Deregister()
    {
        eventSource.Event -= OnEvent;
    }
}</PRE>
<H4>Advantages</H4>
<P>Allows garbage collection of the listener object.</P>
<H4>Disadvantages</H4>
<P>Leaks the wrapper instance when the event never fires; writing a wrapper 
class for each event handler is a lot of repetitive code.</P>
<H3><A id=heading0006 name=heading0006>Solution 3: Deregister in 
Finalizer</A></H3>
<P>Note that we stored a reference to the <CODE>EventWrapper</CODE> and had a 
public <CODE>Deregister</CODE> method. We can add a finalizer to the listener 
and use that to deregister from the event.</P><PRE lang=cs>~ListenerObject() {
    ew.Deregister();
}</PRE>
<P>That should take care of our memory leak, but it comes at a cost: finalizable 
objects are expensive for the garbage collector. When there are no references to 
the listener object (except for the weak reference), it'll survive the first 
garbage collection (and move to a higher generation), have the finalizer run, 
and then can only be collected after the next garbage collection (of the new 
generation).</P>
<P>Also, finalizers run on the finalizer thread; this may cause problems if 
registering/deregistering events on an event source is not thread-safe. 
Remember, the default events generated by the C# compiler are 
<STRONG>not</STRONG> thread-safe!</P>
<H4>Advantages</H4>
<P>Allows garbage collection of the listener object; does not leak wrapper 
instances.</P>
<H4>Disadvantages</H4>
<P>Finalizer delays GC of listener; requires thread-safe event source; lots of 
repetitive code.</P>
<H3><A id=heading0007 name=heading0007>Solution 4: Reusable Wrapper</A></H3>
<P>The code download contains a reusable version of the wrapper class. It works 
by taking the lambda expressions for the code parts that need to be adapted to a 
specific use: Register event handler, deregister event handler, forward the 
event to a <CODE><SPAN class=code-keyword>private</SPAN> </CODE>method.</P><PRE lang=cs>eventWrapper = WeakEventHandler.Register(
    eventSource,
    (s, eh) =&gt; s.Event += eh, <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> registering code</SPAN>
    (s, eh) =&gt; s.Event -= eh, <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> deregistering code</SPAN>
    <SPAN class=code-keyword>this</SPAN>, <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> event listener</SPAN>
    (me, sender, args) =&gt; me.OnEvent(sender, args) <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> forwarding code</SPAN>
);</PRE>
<P><IMG alt=WrapperWithLambdas.png 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/WrapperWithLambdas.png" 
width=403 height=111></P>
<P>The returned <CODE>eventWrapper</CODE> exposes a single <CODE><SPAN 
class=code-keyword>public</SPAN> </CODE>method: <CODE>Deregister</CODE>. Now, we 
need to be careful with lambda expressions, since they are compiled to delegates 
that may contain further object references. That's why the event listener is 
passed back as "<CODE>me</CODE>". Had we written <CODE>(me, sender, args) =<SPAN 
class=code-keyword>&gt;</SPAN> <SPAN 
class=code-keyword>this</SPAN>.OnEvent(sender, args)</CODE>, the lambda 
expression would have captured the "<CODE><SPAN 
class=code-keyword>this</SPAN></CODE>" variable, causing a closure object to be 
generated. Since the <CODE>WeakEventHandler</CODE> stores a reference to the 
forwarding delegate, this would have caused a strong reference from the wrapper 
to the listener. Fortunately, it's possible to check whether a delegate captures 
any variables: the compiler will generate an instance method for lambda 
expressions that capture variables, and a <CODE><SPAN 
class=code-keyword>static</SPAN> </CODE>method for lambda expressions that 
don't. <CODE>WeakEventHandler</CODE> checks this using 
<CODE>Delegate.Method.IsStatic</CODE>, and will throw an exception if you use it 
incorrectly.</P>
<P>This approach is fairly reusable, but it still requires a wrapper class for 
each delegate type. While you can get pretty far with 
<CODE>System.EventHandler</CODE> and <CODE>System.EventHandler<SPAN 
class=code-keyword>&lt;</SPAN>T<SPAN class=code-keyword>&gt;</SPAN></CODE>, you 
might want to automate this when there are lots of different delegate types. 
This could be done at compile-time using code generation, or at runtime using 
<CODE>System.Reflection.Emit</CODE>.</P>
<H4>Advantages</H4>
<P>Allows garbage collection of listener object; code overhead not too bad.</P>
<H4>Disadvantages</H4>
<P>Leaks wrapper instance when event never fires.</P>
<H3><A id=heading0008 name=heading0008>Solution 5: WeakEventManager</A></H3>
<P>WPF has built-in support for listener-side weak events, using the 
<CODE>WeakEventManager</CODE> class. It works similar to the previous wrapper 
solutions, except that a single <CODE>WeakEventManager</CODE> instance serves as 
a wrapper between multiple sender and multiple listeners. Due to this single 
instance, the <CODE>WeakEventManager</CODE> can avoid the leak when the event is 
never called: registering another event on a <CODE>WeakEventManager</CODE> can 
trigger a clean-up of old events. These clean-ups are scheduled using the WPF 
dispatcher, they will occur only on threads running a WPF message loop.</P>
<P>Also, the <CODE>WeakEventManager</CODE> has a restriction that our previous 
solutions didn't have: it requires the sender parameter to be set correctly. If 
you use it to attach to <CODE>button.Click</CODE>, only events with 
<CODE>sender==button</CODE> will be delivered. Some event implementations may 
simply attach the handlers to another event:</P><PRE lang=cs><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>event</SPAN> EventHandler Event {
    add { anotherObject.Event += value; }
    remove { anotherObject.Event -= value; }
}</PRE>
<P>Such events cannot be used with <CODE>WeakEventManager</CODE>.</P>
<P>There is one <CODE>WeakEventManager</CODE> class per event, each with an 
instance per thread. The recommended pattern for defining these events is a lot 
of boilerplate code: see <A 
href="http://msdn.microsoft.com/en-us/library/aa970850.aspx">"WeakEvent 
Patterns" on MSDN</A> <A title="New Window" 
href="http://msdn.microsoft.com/en-us/library/aa970850.aspx" 
target=_blank>[^]</A>.</P>
<P>Fortunately, we can simplify this with Generics:</P><PRE lang=cs><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>sealed</SPAN> <SPAN class=code-keyword>class</SPAN> ButtonClickEventManager
    : WeakEventManagerBase&lt;ButtonClickEventManager, Button&gt;
{
    <SPAN class=code-keyword>protected</SPAN> <SPAN class=code-keyword>override</SPAN> <SPAN class=code-keyword>void</SPAN> StartListening(Button source)
    {
        source.Click += DeliverEvent;
    }

    <SPAN class=code-keyword>protected</SPAN> <SPAN class=code-keyword>override</SPAN> <SPAN class=code-keyword>void</SPAN> StopListening(Button source)
    {
        source.Click -= DeliverEvent;
    }
}</PRE>
<P>Note that <CODE>DeliverEvent</CODE> takes <CODE>(<SPAN 
class=code-SDKkeyword>object</SPAN>, EventArgs)</CODE>, whereas the 
<CODE>Click</CODE> event provides <CODE>(<SPAN 
class=code-SDKkeyword>object</SPAN>, RoutedEventArgs)</CODE>. While there is no 
conversion between delegate types, C# supports <A 
href="http://blogs.msdn.com/ericlippert/archive/2007/10/19/covariance-and-contravariance-in-c-part-three-member-group-conversion-variance.aspx">contravariance 
when creating delegates from method groups</A> [<A title="New Window" 
href="http://blogs.msdn.com/ericlippert/archive/2007/10/19/covariance-and-contravariance-in-c-part-three-member-group-conversion-variance.aspx" 
target=_blank>^</A>].</P>
<H4>Advantages</H4>
<P>Allows garbage collection of listener object; does not leak wrapper 
instances.</P>
<H4>Disadvantages</H4>
<P>Tied to a WPF dispatcher, cannot be easily used on non-UI-threads.</P>
<H2><A id=heading0009 name=heading0009>Part 2: Source-side Weak Events</A></H2>
<P>Here, we'll take a look at ways to implement weak events by modifying the 
event source.</P>
<P>All these have a common <STRONG>advantage</STRONG> over the listener-side 
weak events: we can easily make registering/deregistering handlers 
thread-safe.</P>
<H3><A id=heading0010 name=heading0010>Solution 0: Interface</A></H3>
<P>The <CODE>WeakEventManager</CODE> also deserves to be mentioned in this 
section: as a wrapper, it attaches ("listening-side") to normal C# events, but 
it also provides ("source-side") a weak event to clients.</P>
<P>In the <CODE>WeakEventManager</CODE>, this is the 
<CODE>IWeakEventListener</CODE> interface. The listening object implements an 
interface, and the source simply has a weak reference to the listener and calls 
the interface method.</P>
<P><IMG alt=SourceWithListeners.png 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/SourceWithListeners.png" 
width=202 height=81></P>
<H4><A id=heading0024 name=heading0024>Advantages</A></H4>
<P>Simple and effective.</P>
<H4><A id=heading0025 name=heading0025>Disadvantages</A></H4>
<P>When a listener handles multiple events, you end up with lots of conditions 
in the <CODE>HandleWeakEvent</CODE> method to filter on event type and on event 
source.</P>
<H3><A id=heading0011 name=heading0011>Solution 1: WeakReference to 
Delegate</A></H3>
<P>This is another approach to weak events used in WPF: 
<CODE>CommandManager.InvalidateRequery</CODE> looks like a normal .NET event, 
but it isn't. It holds only a weak reference to the delegate, so registering to 
that <CODE><SPAN class=code-keyword>static</SPAN> </CODE>event does not cause 
memory leaks.</P><IMG alt=WeakDelegateBug.png 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/WeakDelegateBug.png" 
width=305 height=81> 
<P>This is a simple solution, but it's easy for event consumers to forget about 
it and get it wrong:</P><PRE lang=cs>CommandManager.InvalidateRequery += OnInvalidateRequery;

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment>or</SPAN>

CommandManager.InvalidateRequery += <SPAN class=code-keyword>new</SPAN> EventHandler(OnInvalidateRequery);</PRE>
<P>The problem here is that the <CODE>CommandManager</CODE> only holds a weak 
reference to the delegate, and the listener doesn't hold any reference to it. 
So, on the next GC run, the delegate will be garbage collected, and 
<CODE>OnInvalidateRequery</CODE> doesn't get called anymore even if the listener 
object is still in use. To ensure the delegate survives long enough, the 
listener is responsible for keeping a reference to it.</P>
<P><IMG alt=WeakDelegates.png 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/WeakDelegates.png" 
width=305 height=109></P><PRE lang=cs><SPAN class=code-keyword>class</SPAN> Listener {
    EventHandler strongReferenceToDelegate;
    <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>void</SPAN> RegisterForEvent()
    {
        strongReferenceToDelegate = <SPAN class=code-keyword>new</SPAN> EventHandler(OnInvalidateRequery);
        CommandManager.InvalidateRequery += strongReferenceToDelegate;
    }
    <SPAN class=code-keyword>void</SPAN> OnInvalidateRequery(...) {...}
}</PRE>
<P><CODE>WeakReferenceToDelegate</CODE> in the source-code download shows an 
example event implementation that is thread-safe and cleans the handler list 
when another handler is added.</P>
<H4>Advantages</H4>
<P>Doesn't leak delegate instances.</P>
<H4>Disadvantages</H4>
<P>Easy to get wrong: forgetting the strong reference to the delegate causes 
events to fire only until the next garbage collection. This can result in 
hard-to-find bugs.</P>
<H3><A id=heading0012 name=heading0012>Solution 2: object + Forwarder</A></H3>
<P>While solution 0 was adapted from the <CODE>WeakEventManager</CODE>, this 
solution is adapted from the <CODE>WeakEventHandler</CODE> wrapper: register an 
<CODE><SPAN class=code-SDKkeyword>object</SPAN>,ForwarderDelegate</CODE> 
pair.</P>
<P><IMG alt=SmartEventForwarding.png 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/SmartEventForwarding.png" 
width=313 height=150></P><PRE lang=cs>eventSource.AddHandler(<SPAN class=code-keyword>this</SPAN>,
    (me, sender, args) =&gt; ((ListenerObject)me).OnEvent(sender, args));</PRE>
<H4>Advantages</H4>
<P>Simple and effective.</P>
<H4>Disadvantages</H4>
<P>Unusual signature for registering events; forwarding lambda expressions 
require cast.</P>
<H3><A id=heading0013 name=heading0013>Solution 3: SmartWeakEvent</A></H3>
<P>The <CODE>SmartWeakEvent</CODE> in the source code download provides an event 
that looks like a normal .NET event, but keeps weak references to the event 
listener. It does not suffer from the "must keep reference to 
delegate"-problem.</P><PRE lang=cs><SPAN class=code-keyword>void</SPAN> RegisterEvent()
{
    eventSource.Event += OnEvent;
}
<SPAN class=code-keyword>void</SPAN> OnEvent(<SPAN class=code-keyword>object</SPAN> sender, EventArgs e)
{
    ...
}</PRE>
<P>Event definition:</P><PRE lang=cs>SmartWeakEvent&lt;EventHandler&gt; _event
   = <SPAN class=code-keyword>new</SPAN> SmartWeakEvent&lt;EventHandler&gt;();

<SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>event</SPAN> EventHandler Event {
    add { _event.Add(value); }
    remove { _event.Remove(value); }
}

<SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>void</SPAN> RaiseEvent()
{
    _event.Raise(<SPAN class=code-keyword>this</SPAN>, EventArgs.Empty);
}</PRE>
<P>How does it work? Using the <CODE>Delegate.Target</CODE> and 
<CODE>Delegate.Method</CODE> properties, each delegate is split up into a target 
(stored as a weak reference) and the <CODE>MethodInfo</CODE>. When the event is 
raised, the method is invoked using Reflection.</P><IMG 
alt=SmartEventReflection.png 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/SmartEventReflection.png" 
width=313 height=151> 
<P>A possible problem here is that someone might try to attach an anonymous 
method as an event handler that captures a variable.</P><PRE lang=cs><SPAN class=code-keyword>int</SPAN> localVariable = <SPAN class=code-digit>42</SPAN>;
eventSource.Event += <SPAN class=code-keyword>delegate</SPAN> { Console.WriteLine(localVariable); };</PRE>
<P>In this case, the delegate's target object is the closure, which can be 
immediately collected because there are no other references to it. However, the 
<CODE>SmartWeakEvent</CODE> can detect this case and will throw an exception, so 
you won't have any difficulty to debug problems because the event handler is 
deregistered before you think it should be.</P><PRE lang=cs><SPAN class=code-keyword>if</SPAN> (d.Method.DeclaringType.GetCustomAttributes(
  <SPAN class=code-keyword>typeof</SPAN>(CompilerGeneratedAttribute), <SPAN class=code-keyword>false</SPAN>).Length != <SPAN class=code-digit>0</SPAN>)
    <SPAN class=code-keyword>throw</SPAN> <SPAN class=code-keyword>new</SPAN> ArgumentException(...);</PRE>
<H4>Advantages</H4>
<P>Looks like a real weak event; nearly no code overhead.</P>
<H4>Disadvantages</H4>
<P>Invocation using Reflection is slow; does not work in partial trust because 
it uses reflection on <CODE><SPAN class=code-keyword>private</SPAN> 
</CODE>methods.</P>
<H3><A id=heading0014 name=heading0014>Solution 4: FastSmartWeakEvent</A></H3>
<P>The functionality and usage is identical to the <CODE>SmartWeakEvent</CODE>, 
but the performance is dramatically improved.</P>
<P>Here are the benchmark results of an event with two registered delegates (one 
instance method and one <CODE><SPAN class=code-keyword>static</SPAN> 
</CODE>method):</P><PRE lang=text>Normal (strong) event...   16948785 calls per second
Smart weak event...           91960 calls per second
Fast smart weak event...    4901840 calls per second</PRE>
<P>How does it work? We're not using Reflection anymore to call the method. 
Instead, we're compiling a forwarder method (similar to the "forwarding code" in 
the previous solutions) at runtime using 
<CODE>System.Reflection.Emit.DynamicMethod</CODE>.</P>
<H4>Advantages</H4>
<P>Looks like a real weak event; nearly no code overhead.</P>
<H4>Disadvantages</H4>
<P>Does not work in partial trust because it uses reflection on <CODE><SPAN 
class=code-keyword>private</SPAN> </CODE>methods.</P>
<H2><A id=heading0015 name=heading0015>Suggestions</A></H2>
<UL>
  <LI>For anything running on the UI thread in WPF applications (e.g., custom 
  controls that attach events on the model objects), use the 
  <CODE>WeakEventManager</CODE>.</LI>
  <LI>If you want to provide a weak event, use 
  <CODE>FastSmartWeakEvent</CODE>.</LI>
  <LI>If you want to consume an event, use 
<CODE>WeakEventHandler</CODE>.</LI></UL>
<H2><A id=heading0016 name=heading0016>History</A></H2>
<UL>
  <LI>24 Apr 2009: code updated (bug fixes) 
  <UL>
    <LI>Incorrect 'Derived from EventArgs' check reported by olivianer and 
    Fintan</LI>
    <LI>Type safety issue with <CODE>FastSmartWeakEvent</CODE></LI></UL></LI>
  <LI>5 Oct 2008: Article published</LI></UL></DIV><!-- Article Text End -->
<H2>License</H2>
<DIV id=LicenseTerms>
<P>This article, along with any associated source code and files, is licensed 
under <A href="http://www.opensource.org/licenses/mit-license.php">The MIT 
License</A></P></DIV>
<H2 id=ctl00_AboutHeading>About the Author</H2>
<DIV class=float-right>
<DIV class=lqm_ad 
lqm_tags=".NET2.0,.NET3.0,.NET3.5,C#,Dev,WPF,Intermediate,Advanced" 
lqm_country="CH" lqm_format="6" lqm_zone="77" lqm_publisher="495" 
lqm_channel="1" height="250px" width="300px"></DIV></DIV>
<TABLE border=0 cellSpacing=5 cellPadding=0>
  <TBODY>
  <TR vAlign=top>
    <TD style="WIDTH: 155px" 
    id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
      vAlign=top><B><A 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
      href="http://www.codeproject.com/Members/Daniel-Grunwald">Daniel 
      Grunwald</A></B><BR><BR>
      <CENTER></CENTER>
      <DIV class=small-text><SPAN 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle></SPAN><BR><SPAN 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany></SPAN><BR><SPAN 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG alt=Germany 
      src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/DE.gif" 
      width=16 height=11> Germany</SPAN><BR><BR><SPAN 
      id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType>Member</SPAN><BR></DIV></TD>
    <TD>I am currently studying for my CS master in Karlsruhe, Germany.<BR>In 
      my free time, I am the lead developer on the SharpDevelop open source 
      project.<BR></TD></TR></TBODY></TABLE><BR>
<DIV class=clearfix></DIV>
<DIV id=ctl00_RateArticleRow class="clearfix voting-bar">
<DIV style="PADDING-TOP: 8px" class=column8_1><A 
href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#_top">Article 
Top</A></DIV>
<DIV class="column8_7 align-right">
<DIV id=ctl00_RateArticle_RateItemWrapper class="container-rating small-text" 
name="RateItem_29922">
<TABLE cellSpacing=0 cellPadding=0 width="100%" small-text>
  <TBODY>
  <TR>
    <TD style="WHITE-SPACE: nowrap" class=voteTbl align=right>
      <TABLE class=small-text>
        <TBODY>
        <TR vAlign=center>
          <TD id=ctl00_RateArticle_SignIn noWrap><A 
            href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#SignUp">Sign 
            Up</A> to vote for this article </TD></TR></TBODY></TABLE><SPAN 
      id=ctl00_RateArticle_ErrorMessage class=error></SPAN></TD></TR></TBODY></TABLE>
<DIV class=hover-container>
<DIV id=ctl00_RateArticle_RCD class="rating-comment align-left float-right">Add 
a reason or comment to your vote: <A id=clear-rate_ctl00_RateArticle_RCD 
title=close href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#">x</A><BR><TEXTAREA style="WIDTH: 98%" class=RateComment rows=5 cols=60></TEXTAREA> 
</DIV></DIV></DIV></DIV></DIV></FORM>
<DIV 
style="PADDING-BOTTOM: 0px; MARGIN: auto; PADDING-LEFT: 10px; WIDTH: 460px; PADDING-RIGHT: 10px; WHITE-SPACE: nowrap; HEIGHT: 60px; OVERFLOW: hidden; PADDING-TOP: 0px">
<DIV class=lqm_ad 
lqm_tags=".NET2.0,.NET3.0,.NET3.5,C#,Dev,WPF,Intermediate,Advanced" 
lqm_country="CH" lqm_format="1" lqm_zone="77" lqm_publisher="495" 
lqm_channel="1" height="60px" width="468px"></DIV></DIV>
<H2>Comments and Discussions</H2><A name=_comments></A><!-- Forum Start -->
<DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
<TABLE id=ForumTable class="box forum" cellSpacing=0 cellPadding=0>
  <TBODY>
  <TR>
    <TD class="forum-header1 highlight"><B>You must <A 
      href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx%3ffid%3d1527423%26df%3d90%26mpp%3d25%26noise%3d3%26sort%3dPosition%26view%3dQuick">Sign 
      In</A> to use this message board.</B></TD></TR>
  <TR>
    <TD>
      <TABLE border=0 cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR class=forum-header1>
          <TD style="WHITE-SPACE: nowrap"><IMG 
            style="BORDER-RIGHT-WIDTH: 0px; WIDTH: 16px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 16px; VERTICAL-ALIGN: middle; BORDER-LEFT-WIDTH: 0px" 
            alt=FAQ 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/info-16.gif">&nbsp;<A 
            href="http://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
          <TD style="TEXT-ALIGN: right; WHITE-SPACE: nowrap" colSpan=2>
            <FORM 
            style="PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; PADDING-TOP: 0px" 
            method=get action=/script/Forums/Search.aspx?fid=0><INPUT 
            value=1527423 type=hidden name=fid><INPUT class=Frm_Input type=text 
            name=kw>&nbsp;<INPUT class=button value=Search type=submit name=FrmSrch> 
            </FORM></TD></TR>
        <TR class=forum-header2>
          <TD style="WIDTH: 100%" colSpan=3>
            <DIV style="TEXT-ALIGN: right">
            <FORM 
            style="PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px; PADDING-TOP: 0px" 
            method=get 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fcs%2fWeakEvents.aspx&amp;fid=1527423&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick><INPUT 
            value=1527423 type=hidden name=fid><INPUT 
            value=?floc=%2fKB%2fcs%2fWeakEvents.aspx&amp;fid=1527423&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick 
            type=hidden name=currentQS><INPUT value=/KB/cs/WeakEvents.aspx 
            type=hidden name=floc>Noise Tolerance<SELECT class=Frm_DropDown 
            size=1 name=noise> <OPTION value=1>Very High</OPTION><OPTION 
              value=2>High</OPTION><OPTION selected 
              value=3>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
              value=5>Very Low</OPTION></SELECT>&nbsp;&nbsp;Layout<SELECT 
            class=Frm_DropDown size=1 name=view> <OPTION selected 
              value=Quick>Normal</OPTION><OPTION value=Topic>Expand Posts 
              only</OPTION><OPTION value=Expanded>Expand Posts &amp; 
              Replies</OPTION><OPTION value=Thread>Thread View</OPTION><OPTION 
              value=Normal>No Javascript</OPTION><OPTION value=Preview>No JS + 
              Preview</OPTION></SELECT>&nbsp;&nbsp;Per page<SELECT 
            class=Frm_DropDown size=1 name=mpp> <OPTION 
              value=10>10</OPTION><OPTION selected value=25>25</OPTION><OPTION 
              value=50>50</OPTION></SELECT>&nbsp;&nbsp;&nbsp;<INPUT class=button value=Update type=submit name=SetOpt> 
            </FORM></DIV></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD><A name=xx0xx></A>
      <TABLE border=0 cellSpacing=0 cellPadding=2 width="100%">
        <TBODY>
        <TR class=forum-navbar>
          <TD>&nbsp;</TD>
          <TD>Msgs 1 to 25 of 53 (Total in Forum: 53) (<A 
            href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick">Refresh</A>)</TD>
          <TD style="TEXT-ALIGN: right; WHITE-SPACE: nowrap"><SPAN 
            class=toolbar>First</SPAN><SPAN class=toolbar>Prev</SPAN><A 
            class=toolbar 
            href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx" 
            name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD>
      <TABLE class="fixed-layout blank-background" border=0 cellSpacing=0 
      cellPadding=0 width="100%">
        <TBODY>
        <TR>
          <TD><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=5></TD></TR><!-- Start Message head -->
        <TR id=F3714533_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3714533xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/3714533/My-vote-of-2.aspx" 
                  name=3714533>My vote of 2</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=6064322">viking93</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>1:18 30 Dec '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F3714533_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>nice<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3714533">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3714533/My-vote-of-2.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3714533></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F3689116_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3689116xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/3689116/My-vote-of-5.aspx" 
                  name=3689116>My vote of 5</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=180166">Daniele 
                  Mancini</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>7:56 6 Dec '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F3689116_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Clear, concise, explains every 
                              possibility in a simple way.<BR>Nice pictures! 
                              <IMG alt=Smile align=top 
                              src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/smiley_smile.gif"> 
                              <BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3689116">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3689116/My-vote-of-5.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3689116>3.00/5 (1 vote) 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F3556263_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3556263xx></A><IMG 
                  alt=Question align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_question.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/3556263/System-EventHandler-solution.aspx" 
                  name=3556263>System.EventHandler solution</A> <A 
                  title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=652344">consideRatio</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>4:45 5 Aug '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F3556263_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>First: Thank you so much for this 
                              article, it is the best article i have ever 
                              read!<BR><BR>Earlier in a post you 
                              wrote:<BR><BR>"A possible solution would be to 
                              change the class to always use 
                              System.EventHandler&lt;T&gt; (and maybe provide 
                              another version of the class for non-generic 
                              System.EventHandler).<BR>Then we could make the 
                              type parameter just take the EventArgs type 
                              (FastSmartWeakEvent&lt;EventArgs2&gt;) and declare 
                              the Raise method to accept that type."<BR><BR>I'd 
                              like to get my hands on a solution like that! Have 
                              someone has already done it?<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3556263">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3556263/System-EventHandler-solution.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3556263></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F3493612_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3493612xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/3493612/Pub-Sub.aspx" 
                  name=3493612>Pub/Sub</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=1474087">haplo63</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>9:54 4 Jun '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F3493612_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Thank you Daniel, this post have 
                              been very helpful. I have created an example of an 
                              event bus using your Weak Reference to Delegate. I 
                              have blogged about it <A 
                              href="http://u-ix.blogspot.com/">here</A>.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3493612">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3493612/Pub-Sub.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3493612></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F3474800_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3474800xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/3474800/Much-thanks.aspx" 
                  name=3474800>Much thanks</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3643021">chaiguy1337</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>14:56 17 May '10 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F3474800_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>I was looking for a decent but easy 
                              enough solution to the disturbing lack of built-in 
                              support for weak events in .NET. Your 
                              WeakEventHandler class seems to be a very good 
                              (not perfect, but significantly better) solution 
                              to the problem. Thanks a lot for taking the time 
                              to write it, and this very informative and 
                              exhaustive article.<BR>
                              <DIV class=signature><SPAN 
                              style="FONT-SIZE: 7pt">Sad but true: 4/3 of 
                              Americans have difficulty with simple 
                              fractions.<BR><BR>There are 10 types of people in 
                              this world: those who understand binary and those 
                              who don't.<BR><BR>{o,o}.oO( Check out my blog! 
                              )<BR>|)””’)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A 
                              href="http://pihole.org/">http://pihole.org/</A><BR>-”-”-</SPAN></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3474800">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3474800/Much-thanks.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3474800></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F3374465_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3374465xx></A><IMG 
                  alt=News align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_news.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/3374465/Excellent-article-and-an-alternative-idea.aspx" 
                  name=3374465>Excellent article - and an alternative idea</A> 
                  <A title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                  title=associate border=0 alt=associate 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=5264226">Colin 
                  Eberhardt</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>2:16 19 Feb '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F3374465_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Thorough, well written and great 
                              content. 5* from me!<BR><BR>I have also written 
                              about an alternative to weak events, where you 
                              'force' event listener cleanup:<BR><BR><A 
                              href="http://www.scottlogic.co.uk/blog/colin/2010/02/forcing-event-consumer-cleanup-without-weak-events/">http://www.scottlogic.co.uk/blog/colin/2010/02/forcing-event-consumer-cleanup-without-weak-events/</A>[<A 
                              title="New Window" 
                              href="http://www.scottlogic.co.uk/blog/colin/2010/02/forcing-event-consumer-cleanup-without-weak-events/" 
                              target=_blank>^</A>]<BR><BR>Regards,<BR>Colin 
                              E.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3374465">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3374465/Excellent-article-and-an-alternative-idea.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3374465></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F3353170_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3353170xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/3353170/Thread-safety.aspx" 
                  name=3353170>Thread safety</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=2540736">dbonne</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>5:05 2 Feb '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F3353170_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Hi <BR><BR>I am using (an adapted 
                              version) of the FastSmartWeakEvent. <BR><BR>The 
                              problem with FastSmartWeakEvent, for thread 
                              safety, is that the Raise method both does a copy, 
                              and the execution of the delegates. If I want to 
                              make it thread-safe I would need to put a lock 
                              around the whole Raise method. This might lead to 
                              unexpected results as the code that gets executed 
                              is not known, and it might result in a performance 
                              problem if the code if the callback takes a long 
                              time.<BR><BR>I adapted FastSmartWeakEvent:<BR>* 
                              introduced a IRaisable interface with the Raise 
                              method therein.<BR>* added a CreateRaisable() 
                              method in FastSmartWeakEvent returning an 
                              IRaisable object (containing the copy of the 
                              events). CreateRaisable removes any dead 
                              entries.<BR>* removed the original Raise 
                              method.<BR><BR>Now I can do:<BR><BR>IRaisable 
                              r;<BR>lock(eventlock)<BR>r = 
                              fswe.CreateRaisable();<BR>r.Raise(); // outside of 
                              lock.<BR><BR>thanks for a great article and 
                              code!<BR>Dirk<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3353170">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3353170/Thread-safety.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3353170></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F3271620_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx3271620xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/3271620/Thorough-description-of-alternate-approaches.aspx" 
                  name=3271620>Thorough description of alternate approaches</A> 
                  <A title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=757521">ToolmakerSteve2</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>11:41 13 Nov '09 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F3271620_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>I found this article to be amazingly 
                              informative! Taught me a lot about the different 
                              approaches discussed.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3271620">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3271620/Thorough-description-of-alternate-approaches.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3271620>4.00/5 (1 vote) 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2955125_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx2955125xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2955125/well-done.aspx" 
                  name=2955125>well done</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=3222480"><CODE><B>Xmen</B> 
                  </CODE></A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>10:26 8 Mar '09 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2955125_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>this is really best one...5(+) from 
                              me <BR><BR>
                              <DIV 
                              class=ForumSig>TVMU^P[[IGIOQHG^JSH`A#@`RFJ\c^JPL&gt;;"[,*/|+&amp;WLEZGc`AFXc!L<BR>%^]*IRXD#@GKCQ`R\^SF_WcHbORY87֦ʻ6ϣN8ȤBcRAV\Z^&amp;SU~%CSWQ@#2<BR>W_AD`EPABIKRDFVS)EVLQK)JKSQXUFYK[M`UKs*$GwU#(QDXBER@CBN%<BR>Rs0~53%eYrd8mt^7Z6]iTF+(EWfJ9zaK-iTV.C\y&lt;pjxsg-b$f4ia&gt;<BR>--------------------------------------------------------<BR>128 
                              bit encrypted signature, crack if you 
                              can<BR></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2955125">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2955125/well-done.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2955125></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F3175038_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=34><A name=xx3175038xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/3175038/Re-well-done.aspx" 
                  name=3175038>Re: well done</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=5675320">w395115323</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>18:35 26 Aug '09 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F3175038_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 34px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=34 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>up...<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2955125">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3175038/Re-well-done.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3175038></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2952249_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx2952249xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2952249/method-access-exception-ee-TargetMethod-Invoke-tar.aspx" 
                  name=2952249>http://www.codeproject.com/Messages/2952249/method-access-exception-ee-TargetMethod-Invoke-tar.aspx</A> 
                  <A title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=2357210">codemonkeyman2</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>18:54 5 Mar '09 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2952249_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>so i see in your sample that your 
                              event handler is private yet no exception.<BR>In 
                              my case i get the method access exception. if i 
                              change it to public it works. Any 
                          thoughts?<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2952249">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2952249/method-access-exception-ee-TargetMethod-Invoke-tar.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2952249></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2953313_h0 class="MsgHd LoVote HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=34><A name=xx2953313xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2953313/Re-method-access-exception-ee-TargetMethod-Invoke-.aspx" 
                  name=2953313>http://www.codeproject.com/Messages/2953313/Re-method-access-exception-ee-TargetMethod-Invoke-.aspx</A> 
                  <A title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=2357210">codemonkeyman2</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>7:07 6 Mar '09 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2953313_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 34px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=34 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>I thing worth mentioning this only 
                              happens in Silverlight. not a wpf app. my calling 
                              private methods in silverlight is different from 
                              in wpf?<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2952249">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2953313/Re-method-access-exception-ee-TargetMethod-Invoke-.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2953313>1.00/5 (1 vote) 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2953362_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=52><A name=xx2953362xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2953362/Re-method-access-exception-ee-TargetMethod-Invoke-.aspx" 
                  name=2953362>http://www.codeproject.com/Messages/2953362/Re-method-access-exception-ee-TargetMethod-Invoke-.aspx</A> 
                  <A title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=2357210">codemonkeyman2</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>7:55 6 Mar '09 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2953362_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 52px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=52 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>little more research led me to this 
                              article:<BR>http://blogs.infosupport.com/blogs/willemm/archive/2009/02/02/Accessing-private-methods-in-silverlight.aspx<BR>check 
                              it out, though i couldn't make head and tails as 
                              to how to incorporate that into your 
                            solution<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2952249">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2953362/Re-method-access-exception-ee-TargetMethod-Invoke-.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2953362></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2953395_h0 class="MsgHd HiVote HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=52><A name=xx2953395xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2953395/Re-method-access-exception-type-safety-issues-with.aspx" 
                  name=2953395>Re: method access exception // type safety issues 
                  with FastSmartWeakEvent</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=476847">Daniel 
                  Grunwald</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>8:23 6 Mar '09 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2953395_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 52px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=52 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Reflection on private methods is 
                              only allowed with FullTrust, so you can't use it 
                              with Silverlight.<BR>Also, the generated IL code 
                              in FastSmartWeakEvent is unverifiable (and thus 
                              requires FullTrust): there's no cast instruction 
                              to convert from object (the return type of 
                              WeakReference.get_Target) to the type required by 
                              the method call. It's actually type safe because 
                              we know the target method can be called on the 
                              instance stored in the delegate, but .NET cannot 
                              verify this without a runtime 
                              cast.<BR><BR>Actually, the version in this article 
                              punches a hole in the type system: there's no type 
                              check in the second parameter.<BR><PRE><SPAN class=code-keyword>class</SPAN> EventArgs1 : EventArgs { <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>float</SPAN> Num = <SPAN class=code-digit>1</SPAN>;<BR><SPAN class=code-keyword>class</SPAN> EventArgs2 : EventArgs { <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>int</SPAN> Num; }<BR>...<BR>FastSmartWeakEvent<SPAN class=code-keyword>&lt;</SPAN>EventHandler<SPAN class=code-keyword>&lt;</SPAN>EventArgs2<SPAN class=code-keyword>&gt;</SPAN><SPAN class=code-keyword>&gt;</SPAN> fswe = <SPAN class=code-keyword>new</SPAN> FastSmartWeakEvent<SPAN class=code-keyword>&lt;</SPAN>EventHandler<SPAN class=code-keyword>&lt;</SPAN>EventArgs2<SPAN class=code-keyword>&gt;</SPAN><SPAN class=code-keyword>&gt;</SPAN>();<BR>fswe.Add((sender, e) =<SPAN class=code-keyword>&gt;</SPAN> Console.WriteLine(e.Num.ToString()));<BR>fswe.Raise(null, <SPAN class=code-keyword>new</SPAN> EventArgs1());</PRE>This 
                              compiles and runs, and prints 1065353216 (the bits 
                              of 1.0f interpreted as int).<BR><BR>Unfortunately, 
                              I don't see a way to fix in the current 
                              FastSmartWeakEvent class without having a runtime 
                              check on every invocation.<BR>The problem is that 
                              the FastSmartWeakEvent uses the delegate as type 
                              parameter, so it doesn't know the type derived 
                              from EventArgs until runtime.<BR>A possible 
                              solution would be to change the class to always 
                              use System.EventHandler&lt;T&gt; (and maybe 
                              provide another version of the class for 
                              non-generic System.EventHandler).<BR>Then we could 
                              make the type parameter just take the EventArgs 
                              type 
                              (<CODE>FastSmartWeakEvent&lt;EventArgs2&gt;</CODE>) 
                              and declare the Raise method to accept that 
                              type.<BR><BR>With the existing class as here on 
                              code project, callers of the Raise method must be 
                              careful to pass the correct EventArgs type. If you 
                              use the wrong type, you'll get undefined results, 
                              just like a good old unsafe pointer cast in C. 
                              (except that the GC can cause even more trouble if 
                              it can't tell integers from references 
                              anymore)<BR><BR>Hopefully I'll find time this 
                              weekend to update the article.<BR><BR>But that 
                              won't help you for Silverlight, as without 
                              FullTrust, .NET will reject all code that the JIT 
                              cannot prove to be typesafe - and not only the 
                              missing casts are problematic, it won't accept 
                              calls to private methods either.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2952249">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2953395/Re-method-access-exception-type-safety-issues-with.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2953395>5.00/5 (4 votes) 
                          </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2952173_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx2952173xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2952173/Reference.aspx" 
                  name=2952173>Reference</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=2628692">jpbochi</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>16:58 5 Mar '09 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2952173_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>I made a project using your code and 
                              posted on my blog. Check it out <A 
                              href="http://jp-labs.blogspot.com/2009/02/trackable-properties-with-weak-events.html">here</A>[<A 
                              title="New Window" 
                              href="http://jp-labs.blogspot.com/2009/02/trackable-properties-with-weak-events.html" 
                              target=_blank>^</A>].<BR><BR>I included your 
                              source code to download from there too. I hope I'm 
                              not breaking your code license. <IMG 
                              alt="Poke tongue" align=top 
                              src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/smiley_tongue.gif"> 
                              <BR><BR>5 stars to you post! <IMG alt="Thumbs Up" 
                              align=top 
                              src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/thumbs_up.gif"> 
                              <BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2952173">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2952173/Reference.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2952173></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2930954_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx2930954xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2930954/Great-work.aspx" 
                  name=2930954>Great work</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=5913430">xcvsdfsdf</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>22:02 18 Feb '09 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2930954_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>This is the best article I have 
                              read, ever.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2930954">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2930954/Great-work.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2930954></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F3442810_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=34><A name=xx3442810xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/3442810/Re-Great-work.aspx" 
                  name=3442810>Re: Great work</A> <A 
                  title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=4157662">MartinFister</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>6:34 18 Apr '10 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F3442810_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 34px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=34 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Definitely one of the better ones on 
                              here. It does a great job of researching its work 
                              and providing detailed graphics to make it easy to 
                              follow. Overall, a great write up.<BR><BR>Martin 
                              of <A href="http://www.tevaflipflops.net/">Teva 
                              Flip Flops</A><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2930954">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/3442810/Re-Great-work.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF3442810></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2912549_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx2912549xx></A><IMG 
                  alt=Question align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_question.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2912549/Bug.aspx" 
                  name=2912549>Bug?</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=5238400">Fintan</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>5:14 5 Feb '09 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2912549_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>In the weak event classes static 
                              constructors you have code like the 
                              following:<BR><BR><PRE><SPAN class=code-keyword>if</SPAN> (argsParameter.ParameterType.IsSubclassOf(typeof(EventArgs)))<BR>    <SPAN class=code-keyword>throw</SPAN> <SPAN class=code-keyword>new</SPAN> ArgumentException(<SPAN class=code-string>"</SPAN><SPAN class=code-string>The second delegate parameter must be derived from type 'EventArgs'"</SPAN>);</PRE>Shouldn't 
                              that be:<BR><PRE><SPAN class=code-keyword>if</SPAN> (<B>!</B>argsParameter.ParameterType.IsSubclassOf(typeof(EventArgs)))<BR>    <SPAN class=code-keyword>throw</SPAN> <SPAN class=code-keyword>new</SPAN> ArgumentException(<SPAN class=code-string>"</SPAN><SPAN class=code-string>The second delegate parameter must be derived from type 'EventArgs'"</SPAN>);</PRE>Great 
                              job on the article and thank you for taking the 
                              time to write it.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2912549">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2912549/Bug.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2912549></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2914495_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=34><A name=xx2914495xx></A><IMG 
                  alt=Answer align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_answer.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2914495/Re-Bug.aspx" 
                  name=2914495>Re: Bug?</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=476847">Daniel 
                  Grunwald</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>11:52 6 Feb '09 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2914495_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 34px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=34 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>You're right, that's a bug. My 
                              version accepts only System.EventArgs and the 
                              non-EventArgs classes that I wanted to reject, it 
                              fails with derived EventArgs.<BR><BR>The negated 
                              version works with derived EventArgs, but fails 
                              with System.EventArgs itself.<BR>The correct fix 
                              would be:<BR><PRE><SPAN class=code-keyword>if</SPAN> (!(typeof(EventArgs).IsAssignableFrom(argsParameter.ParameterType)))<BR>	<SPAN class=code-keyword>throw</SPAN> <SPAN class=code-keyword>new</SPAN> ArgumentException(<SPAN class=code-string>"</SPAN><SPAN class=code-string>The second delegate parameter must be derived from type 'EventArgs'"</SPAN>);</PRE><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2912549">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2914495/Re-Bug.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2914495></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2904512_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx2904512xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2904512/Great-article-plus-question.aspx" 
                  name=2904512>Great article + question</A> <A 
                  title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=237261">Ajek</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>11:53 30 Jan '09 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2904512_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Detailed explanation<BR><BR>You 
                              mention that other object could clear the 
                              delegates invocationlist (in the beginning of the 
                              article, when explaining the differences between 
                              events and delegates).<BR>I was just wondering how 
                              you could do that?<BR><BR>Best 
                            regards,<BR>Ike<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2904512">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2904512/Great-article-plus-question.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2904512></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2904521_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=34><A name=xx2904521xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2904521/Re-Great-article-plus-question.aspx" 
                  name=2904521>Re: Great article + question</A> <A 
                  title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=476847">Daniel 
                  Grunwald</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>11:59 30 Jan '09 
          &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2904521_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 34px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=34 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>You cannot change the invocation 
                              list of an existing delegate; whenever you add or 
                              remove a handler, you are creating a new delegate 
                              with the new invocation list.<BR><BR>Assume you 
                              have a delegate, not an event:<BR><CODE>public 
                              EventHandler MyEvent;</CODE><BR><BR>Then you can 
                              clear it by setting it to 
                              null:<BR><CODE>someObject.MyEvent = 
                              null;</CODE><BR><BR>Events allow changing the 
                              underlying delegate field by adding or removing 
                              event handlers, but they prevent other changes to 
                              the field (like setting to null).<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2904512">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2904521/Re-Great-article-plus-question.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2904521></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class=msg-divide><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2904920_h0 class="MsgHd HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=52><A name=xx2904920xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2904920/Re-Great-article-plus-question.aspx" 
                  name=2904920>Re: Great article + question</A> <A 
                  title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=237261">Ajek</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>0:39 31 Jan '09 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2904920_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 52px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=52 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Thanks for the answer.<BR>I didn't 
                              realize it would be that easy.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2904512">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2904920/Re-Great-article-plus-question.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2904920></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2895874_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx2895874xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2895874/Great-article.aspx" 
                  name=2895874>Great article</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=483675">Donsw</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>8:51 25 Jan '09 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2895874_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>This is a very good article 
                              congraulations. good research.<BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2895874">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2895874/Great-article.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2895874></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2831046_h0 class="MsgHd Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx2831046xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2831046/Access-to-modified-closure.aspx" 
                  name=2831046>Access to modified closure</A> <A 
                  title="Click to pin message" onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=member 
                  border=0 alt=member 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/member_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=19850">Paul 
                  Hatcher</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>1:42 4 Dec '08 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2831046_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Resharper complains about the code 
                              in MakeDeregisterCodeAndWeakEventHandler as you 
                              are assigning the eventHandler to 
                              weh.deregisterCode, but then changing it.<BR><BR><PRE>EventHandler<SPAN class=code-keyword>&lt;</SPAN>TEventArgs<SPAN class=code-keyword>&gt;</SPAN> eventHandler = null;<BR>			<BR>weh.deregisterCode = <SPAN class=code-keyword>delegate</SPAN> {<BR>	deregisterEvent(senderObject, eventHandler);<BR>};<BR>			<BR>eventHandler = (sender, args) =<SPAN class=code-keyword>&gt;</SPAN> {<BR>	TEventListener listeningObject = (TEventListener)weh.listeningReference.Target;<BR>	<SPAN class=code-keyword>if</SPAN> (listeningObject != null) {<BR>		forwarderAction(listeningObject, sender, args);<BR>		} <SPAN class=code-keyword>else</SPAN> {<BR>	weh.Deregister();<BR>		}<BR>	};<BR><SPAN class=code-keyword>return</SPAN> eventHandler;<BR></PRE>This 
                              means by the time it is invoked the eventHandler 
                              passed to deregisterCode will have your new 
                              definition - is this what was intended, or has 
                              Resharper's parser become confused? <BR><BR>
                              <DIV class=ForumSig>Paul</DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2831046">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2831046/Access-to-modified-closure.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2831046></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR class=quick>
          <TD class="root msg-divide"><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=1></TD></TR><!-- Start Message head -->
        <TR id=F2819600_h0 class="MsgHd LoVote Rt HdUnSel ">
          <TD width="100%">
            <TABLE class=quickHd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR class=hover-row>
                <TD class=Frm_MsgIndent width=16><A name=xx2819600xx></A><IMG 
                  alt=General align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
                  width=16 height=16></TD>
                <TD class="Frm_MsgSubject hover-container"><A id=DynMessLink 
                  href="http://www.codeproject.com/Messages/2819600/Sorry-mate.aspx" 
                  name=2819600>Sorry mate</A> <A title="Click to pin message" 
                  onclick="return Pin(this);" 
                  href="http://www.codeproject.com/KB/cs/WeakEvents.aspx#"><IMG 
                  border=0 alt=Pin align=top 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/pin.gif" 
                  width=13 height=12></A></TD>
                <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG title=mvp 
                  border=0 alt=mvp 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/mvp_sm.gif" 
                  height=16></TD>
                <TD class=Frm_MsgAuthor><A 
                  href="http://www.codeproject.com/script/Membership/View.aspx?mid=569009">Sacha 
                  Barber</A></TD>
                <TD style="WHITE-SPACE: nowrap; VERTICAL-ALIGN: top" 
                class=Frm_MsgDate>1:31 25 Nov '08 
        &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
        <TR style="DISPLAY: none" id=F2819600_h1>
          <TD width="100%">
            <TABLE class=quickBd border=0 cellSpacing=0 cellPadding=0 
            width="100%">
              <TBODY>
              <TR>
                <TD style="WIDTH: 16px" class=Frm_MsgIndent><IMG alt="" 
                  src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
                  width=16 height=1></TD>
                <TD class="MsgBd BdSel ">
                  <TABLE border=0 cellSpacing=5 cellPadding=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE border=0 cellSpacing=0 cellPadding=0 
width="100%">
                          <TBODY>
                          <TR>
                            <TD colSpan=2>Daniel<BR><BR>I was truly sorry to 
                              beat you in the recent C# monthly competition, 
                              this article was/is great. Sorry mate. Keep up the 
                              great work though. <BR><BR>
                              <DIV class=ForumSig><B>Sacha Barber</B><BR>
                              <UL>
                                <LI>Microsoft Visual C# MVP 2008</LI>
                                <LI>Codeproject MVP 2008</LI></UL>Your best friend 
                              is you.<BR>I'm my best friend too. We share the 
                              same views, and hardly ever argue<BR><BR><B>My 
                              Blog : <A href="http://sachabarber.net/" 
                              target=_blank>sachabarber.net</A></B></DIV><BR></TD></TR>
                          <TR style="VERTICAL-ALIGN: middle">
                            <TD class=msg-footer><A class=toolbar 
                              href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fcs%2fWeakEvents.aspx">Sign 
                              In</A>·<A class=toolbar title=View&nbsp;Thread 
                              href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2819600">View&nbsp;Thread</A>·<A 
                              class=toolbar title="Get permanent link" 
                              href="http://www.codeproject.com/Messages/2819600/Sorry-mate.aspx">PermaLink</A></TD>
                            <TD style="TEXT-ALIGN: right" 
                              class=msg-footer><SPAN style="WHITE-SPACE: nowrap" 
                              id=MVF2819600>2.60/5 (5 votes) 
                          </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD><IMG border=0 alt="" 
            src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/t(1).gif" 
            width=1 height=5></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD>
      <TABLE cellSpacing=0 cellPadding=2 width="100%">
        <TBODY>
        <TR class=forum-footer>
          <TD>Last Visit: 3:45 18 Jan '11 &nbsp; &nbsp; Last Update: 3:46 18 
            Jan '11 </TD>
          <TD style="TEXT-ALIGN: right; WHITE-SPACE: nowrap"><INPUT id=_mbnUrl 
            value=/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=26 
            type=hidden><B>1</B><A class=toolbar 
            href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx" 
            name=Frm_HoverNL>2</A><A class=toolbar 
            href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=51#xx0xx" 
            name=Frm_HoverNL>3</A> <A class=toolbar 
            href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?fid=1527423&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx" 
            name=Frm_HoverNL>Next 
»</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
<P class=small-text><IMG alt=General align=top 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_general.gif" 
width=16 height=16> General &nbsp;&nbsp; <IMG alt=News align=top 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_news.gif" 
width=16 height=16> News &nbsp;&nbsp; <IMG alt=Question align=top 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_question.gif" 
width=16 height=16> Question &nbsp;&nbsp; <IMG alt=Answer align=top 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_answer.gif" 
width=16 height=16> Answer &nbsp;&nbsp; <IMG alt=Joke align=top 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_joke.gif" 
width=16 height=16> Joke &nbsp;&nbsp; <IMG alt=Rant align=top 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_rant.gif" 
width=16 height=16> Rant &nbsp;&nbsp; <IMG alt=Admin align=top 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/msg_admin.gif" 
width=16 height=16> Admin &nbsp;&nbsp; </P>
<P class=small-text>Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to 
switch threads, Ctrl+PgUp/PgDown to switch pages.</P><!-- Forum End -->
<DIV style="HEIGHT: 2px" class=theme1-background></DIV>
<DIV class="extended tiny-text">
<DIV style="MARGIN: auto" class=row>
<DIV class=float-left><A id=ctl00_PermaLink 
href="http://www.codeproject.com/KB/cs/WeakEvents.aspx">PermaLink</A> | <A 
id=ctl00_PrivacyLink 
href="http://www.codeproject.com/info/privacy.aspx">Privacy</A> | <A 
id=ctl00_TermsOfUseLink 
href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</A> | <A 
id=ctl00_Mobile 
href="http://www.codeproject.com/KB/cs/WeakEvents.aspx?display=Mobile">Mobile</A> 
<BR>Last Updated: 25 Apr 2009<BR><BR></DIV>
<DIV class="float-right align-right">Copyright 2008 by Daniel 
Grunwald<BR>Everything else Copyright © <A 
href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2011 <BR>Web23 | 
<A id=ctl00_AdvertiseLink 
href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on the Code 
Project </A></DIV></DIV></DIV></DIV>
<DIV id=ctl00_ContentSide class=text-sidebar>
<SCRIPT type=text/javascript>document.write(unescape('%0d%0a%3cdiv class%3d%22announce%22%3e%0d%0a%0d%0a%3cdiv class%3d%22announce-content%22%3e%09%0d%0a%0d%0a%0d%0a%3cdiv class%3d%22container-adwords%22%3e%0d%0a%09%3ca id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Link%22 href%3d%22%2fscript%2fCatalog%2fRedir.aspx%3fctid%3d2393%26amp%3bcttype%3d2%22 target%3d%22_blank%22%3e%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Title%22 class%3d%22title%22%3eResco MobileForms Toolkit%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Teaser%22 title%3d%22The richest%2c most complete and award winning set of components for .NET Compact Framework%22 class%3d%22desc%22%3eThe richest%2c most complete and award winning...%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Url%22 class%3d%22link%22%3ewww.resco.net%3c%2fspan%3e%3c%2fa%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%3cdiv class%3d%22container-adwords%22%3e%0d%0a%09%3ca id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Link%22 href%3d%22%2fscript%2fCatalog%2fRedir.aspx%3fctid%3d2522%26amp%3bcttype%3d2%22 target%3d%22_blank%22%3e%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Title%22 class%3d%22title%22%3eGet 6 Months Free ASP.NET Hosting - Click Here!%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Teaser%22 title%3d%22DiscountASP.NET is a Microsoft Windows-based shared web hosting service provider. Our mission is to deliver the Best Value in advanced ASP.NET web hosting.%22 class%3d%22desc%22%3eDiscountASP.NET is a Microsoft Windows-based...%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Url%22 class%3d%22link%22%3ewww.discountasp.net%3c%2fspan%3e%3c%2fa%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%3cdiv class%3d%22container-adwords%22%3e%0d%0a%09%3ca id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Link%22 href%3d%22%2fscript%2fCatalog%2fRedir.aspx%3fctid%3d2966%26amp%3bcttype%3d2%22 target%3d%22_blank%22%3e%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Title%22 class%3d%22title%22%3eSpread for ASP.NET by GrapeCity%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Teaser%22 title%3d%22FarPoint Spread for ASP.NET 5 by GrapeCity is a full-featured AJAX powered Microsoft Excel compatible spreadsheet component for ASP.NET with integrated charting%2c dynamic data binding%2c Excel import-export and allows full spreadsheet user experience within the browser.%22 class%3d%22desc%22%3eFarPoint Spread for ASP.NET 5 by GrapeCity is...%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Url%22 class%3d%22link%22%3ewww.farpointspread.com%3c%2fspan%3e%3c%2fa%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%0d%0a%3c%2fdiv%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%0d%0a'));</SCRIPT>

<DIV class=announce>
<DIV class=announce-header>See Also...</DIV>
<DIV class=announce-content>
<DIV class=container-related-item><A 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl00_TitleLink class=title 
href="http://www.codeproject.com/KB/aspnet/Creating_PDF_documents_in.aspx">Creating 
PDF Documents in ASP.NET</A><BR><SPAN 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl00_Teaser class=desc>How to create 
PDF documents in ASP.NET.</SPAN><BR></DIV>
<DIV class=container-related-item><A 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl01_TitleLink class=title 
href="http://www.codeproject.com/KB/database/CsvReader.aspx">A Fast CSV 
Reader</A><BR><SPAN id=ctl00_RelatedArticles_RelatedItemRptr_ctl01_Teaser 
class=desc>A reader that provides fast, non-cached,...</SPAN><BR></DIV>
<DIV class=container-related-item><A 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl02_TitleLink class=title 
href="http://www.codeproject.com/KB/aspnet/ImportExportCSV.aspx">A Simplified 
SQL-CSV Import/Export Functionality</A><BR><SPAN 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl02_Teaser class=desc>A simplified 
SQL-CSV import/export functionality.</SPAN><BR></DIV>
<DIV class=container-related-item><A 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl03_TitleLink class=title 
href="http://www.codeproject.com/KB/database/FinalCSVReader.aspx">Importing CSV 
Data and saving it in database</A><BR><SPAN 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl03_Teaser class=desc>This article 
shows how to import CSV data and...</SPAN><BR></DIV>
<DIV class=container-related-item><A 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl04_TitleLink class=title 
href="http://www.codeproject.com/KB/database/TransferUsingSQLBulkCopy.aspx">Transferring 
Data Using SqlBulkCopy</A><BR><SPAN 
id=ctl00_RelatedArticles_RelatedItemRptr_ctl04_Teaser class=desc>An article on 
how to transfer data using...</SPAN><BR></DIV></DIV></DIV>
<DIV class="announce ">
<DIV class=announce-header>Announcements</DIV>
<DIV class=announce-content>
<TABLE cellPadding=2>
  <TBODY>
  <TR vAlign=center>
    <TD><IMG 
      style="BORDER-RIGHT-WIDTH: 0px; WIDTH: 24px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 24px; BORDER-LEFT-WIDTH: 0px" 
      id=ctl00_Announcements_News_ctl00_Img alt=News align=middle 
      src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/14362.png"></TD>
    <TD><A id=ctl00_Announcements_News_ctl00_Link 
      href="http://www.codeproject.com/Competitions/460/Windows-Azure-Marketplace-The-DataMarket-Contest.aspx">Build 
      Azure App - Win a Laptop</A></TD></TR>
  <TR vAlign=center>
    <TD><IMG 
      style="BORDER-RIGHT-WIDTH: 0px; WIDTH: 24px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 24px; BORDER-LEFT-WIDTH: 0px" 
      id=ctl00_Announcements_News_ctl01_Img alt=News align=middle 
      src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/13270.png"></TD>
    <TD><A id=ctl00_Announcements_News_ctl01_Link 
      href="http://www.codeproject.com/Competitions/440/Code-Project-Contests-Windows-Azure-Apps.aspx">Got 
      an Azure app? Win an Xbox &amp; Kinect</A></TD></TR></TBODY></TABLE></DIV></DIV>
<DIV class=announce>
<DIV class=announce-header>The Daily Insider</DIV>
<DIV class=announce-content>
<DIV><A id=ctl00_News_News_ctl01_Link 
href="http://citizen428.net/archives/434">30 free programming 
books</A></DIV>Daily News: <A id=ctl00_News_News_ctl02_Subscribe 
href="http://www.codeproject.com/Feature/Insider/">Signup now</A>. </DIV></DIV>
<DIV style="MARGIN: auto; WIDTH: 150px">
<DIV class=lqm_ad 
lqm_tags=".NET2.0,.NET3.0,.NET3.5,C#,Dev,WPF,Intermediate,Advanced" 
lqm_country="CH" lqm_format="21" lqm_zone="77" lqm_publisher="495" 
lqm_channel="1" height="80px" width="150px"></DIV></DIV>
<DIV style="MARGIN: 10px auto auto; WIDTH: 160px">
<DIV class=lqm_ad 
lqm_tags=".NET2.0,.NET3.0,.NET3.5,C#,Dev,WPF,Intermediate,Advanced" 
lqm_country="CH" lqm_format="18" lqm_zone="77" lqm_publisher="495" 
lqm_channel="1" height="600px" 
width="160px"></DIV></DIV></DIV></DIV></DIV></DIV></DIV>
<SCRIPT language=Javascript type=text/javascript 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/jquery-1.4.2.min.js"></SCRIPT>

<SCRIPT type=text/javascript>//<![CDATA[
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='/script/JS/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
}//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/article.min.js"></SCRIPT>

<SCRIPT language=Javascript type=text/javascript 
src="Week%20Events%20in%20C%23%20by%20Daniel%20Grunwald_files/m.min.js"></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var socialLinks = new social();
socialLinks.PlaceholderId="ATD";socialLinks.ObjectId=29922;
socialLinks.ObjectTypeId=2;
socialLinks.addtoMethod=1;
socialLinks.Horizontal=false;
socialLinks.Showname=true;
socialLinks.setupLinks("socialLinks", escape(document.location.href),escape(document.title), 100, 0, "small-text Bold", "AddTo");
socialLinks.setupMenu();
if($.LqmAds)$.LqmAds();
var oSrchFlt = false, oSrchBox=false,srchBoxFoc=false;
$(document).ready(function() {
 InitWatermark('sb_tb', 'Search');
 var sbar = $('#sb_tb'); 
 var sfilter = $('#SearchFilter');
 if (sbar && sfilter) {
  sfilter.removeClass('popup'); sfilter.hide();
  sbar.blur(function() { if (!oSrchFlt)sfilter.hide();srchBoxFoc=false; });
  sbar.focus(function() { oSrchFlt=false;srchBoxFoc=true;sfilter.show(); });
  sbar.mouseleave(function() { oSrchBox=false; });
  sbar.mouseover(function() { oSrchBox=true; });
  sfilter.mouseleave(function() { oSrchFlt=false; if (!srchBoxFoc&&!oSrchBox)sfilter.hide();});
  sfilter.mouseover(function() { oSrchFlt=true; });
 }
});
$("#ctl00_RateArticle_RateItemWrapper").removeClass("container-rating");$('#clear-rate_ctl00_RateArticle_RCD').click(function () { $('#ctl00_RateArticle_RCD').hide(); return false;});
function ChkRtctl00_RateArticle(val, objId) {if (val<=3||true) {
$('div[name=RateItem_' + objId + '] .rating-comment').css("display","");}
else $('div[name=RateItem_' + objId + '] .rating-comment').css("display","none");}


//]]>
</SCRIPT>

<SCRIPT type=text/javascript>
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</SCRIPT>
</BODY></HTML>
